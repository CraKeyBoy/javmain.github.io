<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Javmain&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.51itzone.cn/"/>
  <updated>2018-08-20T02:11:16.648Z</updated>
  <id>https://blog.51itzone.cn/</id>
  
  <author>
    <name>javmain</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>python è™šæ‹Ÿç¯å¢ƒç®¡ç† pipenv ä½¿ç”¨</title>
    <link href="https://blog.51itzone.cn/2018/05/08/python-pipenv-how-use/"/>
    <id>https://blog.51itzone.cn/2018/05/08/python-pipenv-how-use/</id>
    <published>2018-05-08T02:43:22.000Z</published>
    <updated>2018-08-20T02:11:16.648Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/pypa/pipenv" target="_blank" rel="noopener">pipenv</a> æ˜¯ 2017 å¹´ 1 æœˆç”± <a href="https://www.kennethreitz.org/" target="_blank" rel="noopener">Kennethreitz</a> å¤§ç¥åˆ›ä½œï¼Œç›®å‰å·²ç»æœ‰ 286 ä¸ªç‰ˆæœ¬å‘å¸ƒï¼Œå¯è§åœ¨ GitHub ä¸Šæ˜¯éå¸¸æ´»è·ƒçš„é¡¹ç›®ã€‚ç®€å•æ¥è¯´ pipenv çš„æ˜¯ç®¡ç† python ç¯å¢ƒå’Œ python ä¾èµ–åŒ…çš„å·¥å…·ã€‚ä½¿ç”¨æ—¶ pipenv ä¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå¹¶ä¸”æ–°å¢äº† Pipfile æ–‡ä»¶æ¥ç»´æŠ¤åŒ…ä¾èµ–ï¼Œ æ–°å¢ Pipfile.lock å·²åœ¨ç¡®å®šç¯å¢ƒå’Œä¾èµ–åé”å®šé¡¹ç›®ï¼Œä»¥ä¾¿æœ€ç»ˆç‰ˆæœ¬å‘å¸ƒã€‚ pipenv è¿˜æ˜¯ Python.org æ­£å¼æ¨èçš„ python åŒ…ç®¡ç†å·¥å…·ã€‚<br>å¼•ç”¨å®˜æ–¹è¯´æ˜ï¼š</p><blockquote><p>Pipenv â€” the officially recommended Python packaging tool from Python.org, free (as in freedom).<br><a id="more"></a></p></blockquote><h1 id="pipevn-å¯ä»¥è§£å†³é‚£äº›é—®é¢˜"><a href="#pipevn-å¯ä»¥è§£å†³é‚£äº›é—®é¢˜" class="headerlink" title="pipevn å¯ä»¥è§£å†³é‚£äº›é—®é¢˜"></a>pipevn å¯ä»¥è§£å†³é‚£äº›é—®é¢˜</h1><ol><li><p>ä½¿ç”¨ pipevn å°±ç›¸å½“äºåŒæ—¶ä½¿ç”¨äº† pip å’Œ virtualenv ï¼Œå³åšåˆ°åŒ…ç®¡ç†åˆå¯ä»¥ç®¡ç†è™šæ‹Ÿç¯å¢ƒã€‚</p></li><li><p>ä½¿ç”¨ pipevn è§£å†³ requirement.txt é¢ä¸´çš„<a href="https://www.kennethreitz.org/essays/a-better-pip-workflow" target="_blank" rel="noopener">é—®é¢˜</a></p></li><li><p>pipenv ä½¿ç”¨ Pipfile ä»£æ›¿ requirement.txt æ–‡ä»¶æ¥è®°å½•é¡¹ç›®ä¾èµ–åŒ…ã€‚</p></li><li><p>æ–°å¢äº† Pipfile.lock æ–‡ä»¶æ¥é”å®š python è½¯ä»¶çš„åŒ…ååŠç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä¾èµ–å…³ç³»çš„åˆ—è¡¨ã€‚</p></li><li><p>å®ƒå‚è€ƒäº†å…¶ä»–è¯­è¨€çš„åŒ…ç®¡ç†å·¥å…·ï¼ˆbundler, composer, npm, cargo, yarn, etc.ï¼‰ï¼Œæ—¨åœ¨å°†æœ€å¥½çš„åŒ…ç®¡ç†å·¥å…·å¸¦å…¥ python ä¸–ç•Œã€‚</p></li></ol><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h2><p>ä½¿ç”¨ Homebrew å®‰è£…:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install pipenv</span><br></pre></td></tr></table></figure><h2 id="Ubuntu17-10"><a href="#Ubuntu17-10" class="headerlink" title="Ubuntu17.10"></a>Ubuntu17.10</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install software-properties-common python-software-properties</span><br><span class="line">sudo add-apt-repository ppa:pypa/ppa</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install pipenv</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-pip-å®‰è£…"><a href="#ä½¿ç”¨-pip-å®‰è£…" class="headerlink" title="ä½¿ç”¨ pip å®‰è£…"></a>ä½¿ç”¨ pip å®‰è£…</h2><p>ä½œè€…æ¨èåœ¨ python3 ä¸‹è¾¹å®‰è£…ï¼Œä¼šæé«˜ä¸ virtualenv çš„å…¼å®¹æ€§ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pipenv</span><br></pre></td></tr></table></figure><p>ä¸ºé˜²æ­¢å’Œç³»ç»Ÿpythonåº“äº§ç”Ÿå½±å“ï¼Œå¯ä½¿ç”¨æ­¤ç§æ–¹æ¡ˆå®‰è£…ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user pipenv</span><br></pre></td></tr></table></figure><p>pip é»˜è®¤å®‰è£…åŒ…è·¯å¾„ä¸º /usr/local/lib/python2.7/site-packages ã€‚æ­¤æ¨¡å¼ä¸‹ï¼Œpip å®‰è£…åŒ…ä¿å­˜è·¯å¾„ä¸ºç”¨æˆ·åº“è·¯å¾„,å¯ä½¿ç”¨å‘½ä»¤ python3 -m site â€“user-site å…·ä½“æŸ¥çœ‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> python3 -m site --user-site</span><br><span class="line">/Users/apple/Library/Python/3.6/lib/python/site-packages</span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨å®‰è£…åä½ çš„ shell ä¸­ pipenv ä¸å¯ç”¨ï¼Œä½ éœ€è¦æŠŠç”¨æˆ·åº“çš„äºŒè¿›åˆ¶ç›®å½• /Users/apple/Library/Python/3.6/bin æ·»åŠ åˆ°ä½ çš„ PATH ä¸­ã€‚</p><h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><h2 id="pipenv-è™šæ‹Ÿç¯å¢ƒä½¿ç”¨"><a href="#pipenv-è™šæ‹Ÿç¯å¢ƒä½¿ç”¨" class="headerlink" title="pipenv è™šæ‹Ÿç¯å¢ƒä½¿ç”¨"></a>pipenv è™šæ‹Ÿç¯å¢ƒä½¿ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> åˆ›å»ºå®ä¾‹é¡¹ç›®</span><br><span class="line"><span class="meta">$</span> mkdir PipenvDemo</span><br><span class="line"><span class="meta">$</span> cd PipenvDemo</span><br><span class="line"><span class="meta">$</span> touch helloworld.py</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span> vim helloworld.py</span><br><span class="line">print("hello world")</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span> python3 helloworld.py</span><br><span class="line">hello world</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ä½¿ç”¨ python3 åˆ›å»º pipenv è™šæ‹Ÿç¯å¢ƒ</span><br><span class="line"><span class="meta">$</span> pipenv install --three</span><br><span class="line">Creating a Pipfile for this projectâ€¦  # è‡ªåŠ¨åˆ›å»º Pipfile</span><br><span class="line">Pipfile.lock not found, creatingâ€¦     # è‡ªåŠ¨åˆ›å»º Pipfile.lock</span><br><span class="line">Locking [dev-packages] dependenciesâ€¦</span><br><span class="line">Locking [packages] dependenciesâ€¦</span><br><span class="line">Updated Pipfile.lock (ca72e7)!</span><br><span class="line">Installing dependencies from Pipfile.lock (ca72e7)â€¦</span><br><span class="line">  ğŸ   â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰ 0/0 â€” 00:00:00</span><br><span class="line">To activate this project's virtualenv, run the following:</span><br><span class="line"><span class="meta">  $</span> pipenv shell</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒä½ç½®</span><br><span class="line"><span class="meta">$</span> pipenv --venv</span><br><span class="line">/Users/apple/.local/share/virtualenvs/PipenvDemo-jMTXT_BG</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹ python è§£æå™¨ä½ç½®</span><br><span class="line"><span class="meta">$</span> pipenv --py</span><br><span class="line">/Users/apple/.local/share/virtualenvs/PipenvDemo-jMTXT_BG/bin/python</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è¿è¡Œ</span><br><span class="line"><span class="meta">$</span> pipenv run python helloworld.py</span><br><span class="line">hello world</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ä½¿ç”¨ pipenv åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒè¿è¡Œ</span><br><span class="line"><span class="meta">$</span> pipenv shell</span><br><span class="line">Spawning environment shell (/bin/zsh). Use 'exit' to leave.</span><br><span class="line">. /Users/apple/.local/share/virtualenvs/PipenvDemo-jMTXT_BG/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æŸ¥è¯¢å½“å‰ç¯å¢ƒ python çš„ä½ç½®</span><br><span class="line"><span class="meta">$</span> which python</span><br><span class="line">/Users/apple/.local/share/virtualenvs/PipenvDemo-jMTXT_BG/bin/python</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹å½“å‰ç¯å¢ƒ python çš„ç‰ˆæœ¬</span><br><span class="line"><span class="meta">$</span> python -V</span><br><span class="line">Python 3.6.5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è¿è¡Œ python ç¨‹åº</span><br><span class="line">python helloworld.py</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> å®‰è£…ä¾èµ–åŒ…</span><br><span class="line"><span class="meta">$</span> pipenv install requests</span><br><span class="line">Installing requestsâ€¦</span><br><span class="line">Collecting requests...</span><br><span class="line">Successfully installed certifi-2018.4.16 chardet-3.0.4 idna-2.6 requests-2.18.4 urllib3-1.22</span><br><span class="line"></span><br><span class="line">Adding requests to Pipfile's [packages]â€¦</span><br><span class="line">Pipfile.lock (ca72e7) out of date, updating to (b14837)â€¦</span><br><span class="line">Locking [dev-packages] dependenciesâ€¦</span><br><span class="line">Locking [packages] dependenciesâ€¦</span><br><span class="line">Updated Pipfile.lock (b14837)!...</span><br><span class="line"></span><br><span class="line"><span class="meta"> #</span> æŸ¥çœ‹å®‰è£…åŒ…ä¾èµ–</span><br><span class="line"><span class="meta"> $</span> pipenv graph</span><br><span class="line">requests==2.18.4</span><br><span class="line">  - certifi [required: &gt;=2017.4.17, installed: 2018.4.16]</span><br><span class="line">  - chardet [required: &gt;=3.0.2,&lt;3.1.0, installed: 3.0.4]</span><br><span class="line">  - idna [required: &gt;=2.5,&lt;2.7, installed: 2.6]</span><br><span class="line">  - urllib3 [required: &lt;1.23,&gt;=1.21.1, installed: 1.22]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ä¾èµ–åŒ…åªå®‰è£…åœ¨å¼€å‘ç¯å¢ƒ</span><br><span class="line"><span class="meta">$</span> pipenv install pytest --dev</span><br><span class="line">Installing pytest...</span><br><span class="line">...</span><br><span class="line">Adding pytest to Pipfile's [dev-packages]...</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹ Pipfile æ–‡ä»¶,å‘ç° pytest æ”¾åˆ°äº† dev-packages ä¸‹</span><br><span class="line"><span class="meta">$</span> cat Pipfile</span><br><span class="line">[[source]]</span><br><span class="line">url = "https://pypi.org/simple"</span><br><span class="line">verify_ssl = true</span><br><span class="line">name = "pypi"</span><br><span class="line"></span><br><span class="line">[packages]</span><br><span class="line">requests = "*"</span><br><span class="line"></span><br><span class="line">[dev-packages]</span><br><span class="line">pytest = "*"</span><br><span class="line"></span><br><span class="line">[requires]</span><br><span class="line">python_version = "3.6"</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå·²ç»å¯ä»¥æŒæ¡å¤§éƒ¨åˆ†ä½¿ç”¨æ–¹æ³•ï¼Œæ›´å¤šå‘½ä»¤è¯¦ç»†å†…å®¹è¯»è€…å¯å‚è€ƒï¼š<a href="https://docs.pipenv.org/basics/" target="_blank" rel="noopener">basics</a></p><h1 id="é«˜çº§ä½¿ç”¨"><a href="#é«˜çº§ä½¿ç”¨" class="headerlink" title="é«˜çº§ä½¿ç”¨"></a>é«˜çº§ä½¿ç”¨</h1><h2 id="å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆ"><a href="#å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆ" class="headerlink" title="å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆ"></a>å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆ</h2><p>å¦‚æœä½ ä½¿ç”¨ bash æˆ–è€… zshï¼Œ ä½ å¯ä»¥åœ¨ ~/.bash_profile (~/.zshrc) ä¸­è®¾ç½®å¦‚ä¸‹å˜é‡ï¼Œä½¿ç”¨å‘½ä»¤æ—¶æŒ‰ tab é”®ä¼šè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼Œéå¸¸æ–¹ä¾¿</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval "$(pipenv --completion)"</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-requirements-txt-æ¥å®‰è£…åŒ…ä¾èµ–"><a href="#ä½¿ç”¨-requirements-txt-æ¥å®‰è£…åŒ…ä¾èµ–" class="headerlink" title="ä½¿ç”¨ requirements.txt æ¥å®‰è£…åŒ…ä¾èµ–"></a>ä½¿ç”¨ requirements.txt æ¥å®‰è£…åŒ…ä¾èµ–</h2><p>é€šè¿‡ requirements.txt å®‰è£…ï¼Œé‡ç”¨ requirements.txt æ¥æ„å»ºæ–°ç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install -r requirements.txt</span><br></pre></td></tr></table></figure><h2 id="è‡ªåŠ¨å®‰è£…-python"><a href="#è‡ªåŠ¨å®‰è£…-python" class="headerlink" title="è‡ªåŠ¨å®‰è£… python"></a>è‡ªåŠ¨å®‰è£… python</h2><p>å¦‚æœä½ ä¹‹å‰ä½¿ç”¨çš„æ˜¯ pyenv æ¥ç®¡ç† python çš„ç‰ˆæœ¬ï¼Œå½“ä½¿ç”¨ pipenv install çš„æ—¶å€™ pipenv ä¼šè‡ªåŠ¨æ£€æµ‹ python æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¯¢é—®ä½ æ˜¯å¦è¦å®‰è£…è¯¥ç‰ˆæœ¬çš„ python</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> cat Pipfile</span><br><span class="line">[[source]]</span><br><span class="line">url = "https://pypi.python.org/simple"</span><br><span class="line">verify_ssl = true</span><br><span class="line"></span><br><span class="line">[dev-packages]</span><br><span class="line"></span><br><span class="line">[packages]</span><br><span class="line">requests = "*"</span><br><span class="line"></span><br><span class="line">[requires]</span><br><span class="line">python_version = "3.6"</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span> pipenv install</span><br><span class="line">Warning: Python 3.6 was not found on your systemâ€¦</span><br><span class="line">Would you like us to install latest CPython 3.6 with pyenv? [Y/n]: y</span><br><span class="line">Installing CPython 3.6.2 with pyenv (this may take a few minutes)â€¦</span><br><span class="line">...</span><br><span class="line">Making Python installation globalâ€¦</span><br><span class="line">Creating a virtualenv for this projectâ€¦</span><br><span class="line">Using /Users/apple/.pyenv/shims/python3 to create virtualenvâ€¦</span><br><span class="line">...</span><br><span class="line">No package provided, installing all dependencies.</span><br><span class="line">...</span><br><span class="line">Installing dependencies from Pipfile.lockâ€¦</span><br><span class="line">ğŸ â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰  5/5 â€” 00:00:03</span><br><span class="line">To activate this project's virtualenv, run the following:</span><br><span class="line"><span class="meta"> $</span> pipenv shell</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹é»˜è®¤-python-ç‰ˆæœ¬"><a href="#ä¿®æ”¹é»˜è®¤-python-ç‰ˆæœ¬" class="headerlink" title="ä¿®æ”¹é»˜è®¤ python ç‰ˆæœ¬"></a>ä¿®æ”¹é»˜è®¤ python ç‰ˆæœ¬</h2><p>Pipenv é»˜è®¤ä½¿ç”¨ python3 æ¥åˆå§‹åŒ–é¡¹ç›®ï¼Œä½ å¯ä»¥é€šè¿‡ ä½¿ç”¨ â€“three æˆ–è€… â€“two æ ‡è¯†æ¥æ”¹å˜åˆå§‹åŒ–ç¯å¢ƒçš„ python ç‰ˆæœ¬ã€‚ä¹Ÿå¯ä»¥æŒ‡å®š PIPENV_DEFAULT_PYTHON_VERSION å€¼æ¥æŒ‡å®š python ç‰ˆæœ¬ã€‚</p><h2 id="è‡ªåŠ¨åŠ è½½-env-æ–‡ä»¶"><a href="#è‡ªåŠ¨åŠ è½½-env-æ–‡ä»¶" class="headerlink" title="è‡ªåŠ¨åŠ è½½ .env æ–‡ä»¶"></a>è‡ªåŠ¨åŠ è½½ .env æ–‡ä»¶</h2><p>å¦‚æœåœ¨ä½ çš„é¡¹ç›®ä¸­åŒ…å« .env æ–‡ä»¶ï¼Œä½¿ç”¨ $ pipenv shell å’Œ $ pipenv run å°†ä¼šè‡ªåŠ¨åŠ è½½è¯¥æ–‡ä»¶ã€‚<br>å¦‚æœä½ çš„ .env æ–‡ä»¶æ²¡æœ‰åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæˆ–è€…ä¸å« .env ,ä½ å¯ä»¥ä½¿ç”¨å¦‚æœå‘½ä»¤æŒ‡å®šæ–‡ä»¶ä½ç½®æˆ–åç§°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PIPENV_DOTENV_LOCATION=/path/to/.env pipenv shell</span><br></pre></td></tr></table></figure><p>é˜»æ­¢ pipenv è‡ªåŠ¨åŠ è½½ .env æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PIPENV_DONT_LOAD_ENV=1 pipenv shell</span><br></pre></td></tr></table></figure><p>æ›´å¤šé«˜çº§å‘½ä»¤åŠä½¿ç”¨è¯¦ç»†å†…å®¹å¯å‚è€ƒï¼š<a href="https://docs.pipenv.org/advanced/" target="_blank" rel="noopener">advanced</a></p><h1 id="ç»“åˆ-vs-code-ä½¿ç”¨"><a href="#ç»“åˆ-vs-code-ä½¿ç”¨" class="headerlink" title="ç»“åˆ vs code ä½¿ç”¨"></a>ç»“åˆ vs code ä½¿ç”¨</h1><p>vs code å·²ç»æ”¯æŒ pipenv çš„ä½¿ç”¨ï¼Œå®˜æ–¹è¯´æ˜ï¼š</p><blockquote><p>A pipenv environment for the workplace folder. If one is found then no other interpreters are searched for or listed as pipenv expects to manage all aspects of the environment.</p></blockquote><p>å¤§æ„æ˜¯ï¼šé¡¹ç›®å¦‚æœä½¿ç”¨ pipenv ç¯å¢ƒï¼Œä¸€æ—¦å‘ç°ä½¿ç”¨äº† pipenv ï¼Œåˆ™åªåˆ—å‡ºæ­¤é¡¹ç›®çš„ interpreter ï¼Œä¸ä¼šåœ¨æœç´¢å…¶ä»–çš„ python è§£æå™¨ï¼Œå› ä¸º pipenv å¯ä»¥ç®¡ç†ç¯å¢ƒçš„å„ä¸ªæ–¹é¢ã€‚</p><p>ä½¿ç”¨ vs code ä½œä¸ºå¼€å‘å·¥å…·ï¼Œæ‰“å¼€å·²ç»ç”Ÿæˆ Pipfile æ–‡ä»¶çš„é¡¹ç›®ï¼Œåœ¨é€‰æ‹© python interperter (â‡§âŒ˜P) æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯æç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Workspace contains pipfile but attempt to run pipenv --venv failed with Traceback (most recent call last):</span><br><span class="line">File /usr/local/Cellar/pipenv/11.10.3/libexec/bin/pipenv, line 11, in &lt;module&gt; load_entry_point(pipenv==11.10.3, console_scripts, pipenv)() File /usr/local/Cellar/pipenv/11.10.3/libexec/lib/python3.6/site-packages/pipenv/vendor/click/core.py, line 722, in __call__ return self.main(*args, **kwargs) File /usr/local/Cellar/pipenv/11.10.3/libexec/lib/python3.6/site-packages/pipenv/vendor/click/core.py, line 676, in main _verify_python3_env() File /usr/local/Cellar/pipenv/11.10.3/libexec/lib/python3.6/site-packages/pipenv/vendor/click/_unicodefun.py, line 118, in _verify_python3_env for mitigation steps. + extra) RuntimeError: Click will abort further execution because Python 3 was configured to use ASCII as encoding for the environment. Consult http://click.pocoo.org/python3/for mitigation steps. This system lists a couple of UTF-8 supporting locales that you can pick from. The following suitable locales where discovered: af_ZA.UTF-8, am_ET.UTF-8, be_BY.UTF-8, bg_BG.UTF-8, ca_ES.UTF-8, cs_CZ.UTF-8, da_DK.UTF-8, de_AT.UTF-8, de_CH.UTF-8, de_DE.UTF-8, el_GR.UTF-8, en_AU.UTF-8, en_CA.UTF-8, en_GB.UTF-8, en_IE.UTF-8, en_NZ.UTF-8, en_US.UTF-8, es_ES.UTF-8, et_EE.UTF-8, eu_ES.UTF-8, fi_FI.UTF-8, fr_BE.UTF-8, fr_CA.UTF-8, fr_CH.UTF-8, fr_FR.UTF-8, he_IL.UTF-8, hr_HR.UTF-8, hu_HU.UTF-8, hy_AM.UTF-8, is_IS.UTF-8, it_CH.UTF-8, it_IT.UTF-8, ja_JP.UTF-8, kk_KZ.UTF-8, ko_KR.UTF-8, lt_LT.UTF-8, nl_BE.UTF-8, nl_NL.UTF-8, no_NO.UTF-8, pl_PL.UTF-8, pt_BR.UTF-8, pt_PT.UTF-8, ro_RO.UTF-8, ru_RU.UTF-8, sk_SK.UTF-8, sl_SI.UTF-8, sr_YU.UTF-8, sv_SE.UTF-8, tr_TR.UTF-8, uk_UA.UTF-8, zh_CN.UTF-8, zh_HK.UTF-8, zh_TW.UTF-8. Make sure pipenv is on the PATH.</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š<br>å¦‚æœæ˜¯ç®€ä½“ä¸­æ–‡ç¯å¢ƒï¼Œåˆ™åœ¨ ~/.bash_profile (~/.zshrc) ä¸­è®¾ç½®å¦‚ä¸‹å˜é‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LC_ALL=zh_CN.UTF-8</span><br><span class="line">export LANG=zh_CN.UTF-8</span><br></pre></td></tr></table></figure><p>è‹±æ–‡ç¯å¢ƒï¼Œè®¾ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LC_ALL=en_US.UTF-8</span><br><span class="line">export LANG=en_US.UTF-8</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source .bash_profile(.zshrc)</span><br></pre></td></tr></table></figure><p>ï¼ˆä¸æ¨èï¼‰å¦‚æœä»»ç„¶æŠ¥é”™ï¼Œåˆ™å¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹æ–°å»º .env æ–‡ä»¶ï¼Œå¹¶æ‹·è´ä¸Šæ–‡ä¸­çš„ shell è„šæœ¬ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>pipenv ä¸»è¦æ˜¯ç”¨æ¥è§£å†³ python ç‰ˆæœ¬å’ŒåŒ…ä¾èµ–çš„ç®¡ç†</li><li>ç†Ÿæ‚‰äº† pipenv å®‰è£…å’Œè™šæ‹Ÿç¯å¢ƒçš„æ­å»º</li><li>é€šè¿‡ç¤ºä¾‹æ¥å­¦ä¹  pipenv çš„åŸºæœ¬å‘½ä»¤ä½¿ç”¨</li><li>é€šè¿‡å­¦ä¹ é«˜çº§å‘½ä»¤æ¥ä½¿é¡¹ç›®å…·æœ‰å·¥ç¨‹ä¸Šçš„å¯ç”¨</li><li>äº†è§£ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•</li></ul><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><blockquote><p><a href="https://docs.pipenv.org/" target="_blank" rel="noopener">pipenv doc</a><br><a href="https://github.com/pypa/pipenv" target="_blank" rel="noopener">pipenv github</a><br><a href="http://pylixm.cc/posts/2018-01-13-python-pipenv.html" target="_blank" rel="noopener">pipenv è¯•ç”¨è¿‡ç¨‹åˆ†äº«</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/pypa/pipenv&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;pipenv&lt;/a&gt; æ˜¯ 2017 å¹´ 1 æœˆç”± &lt;a href=&quot;https://www.kennethreitz.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Kennethreitz&lt;/a&gt; å¤§ç¥åˆ›ä½œï¼Œç›®å‰å·²ç»æœ‰ 286 ä¸ªç‰ˆæœ¬å‘å¸ƒï¼Œå¯è§åœ¨ GitHub ä¸Šæ˜¯éå¸¸æ´»è·ƒçš„é¡¹ç›®ã€‚ç®€å•æ¥è¯´ pipenv çš„æ˜¯ç®¡ç† python ç¯å¢ƒå’Œ python ä¾èµ–åŒ…çš„å·¥å…·ã€‚ä½¿ç”¨æ—¶ pipenv ä¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå¹¶ä¸”æ–°å¢äº† Pipfile æ–‡ä»¶æ¥ç»´æŠ¤åŒ…ä¾èµ–ï¼Œ æ–°å¢ Pipfile.lock å·²åœ¨ç¡®å®šç¯å¢ƒå’Œä¾èµ–åé”å®šé¡¹ç›®ï¼Œä»¥ä¾¿æœ€ç»ˆç‰ˆæœ¬å‘å¸ƒã€‚ pipenv è¿˜æ˜¯ Python.org æ­£å¼æ¨èçš„ python åŒ…ç®¡ç†å·¥å…·ã€‚&lt;br&gt;å¼•ç”¨å®˜æ–¹è¯´æ˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pipenv â€” the officially recommended Python packaging tool from Python.org, free (as in freedom).&lt;br&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://blog.51itzone.cn/categories/Technology/"/>
    
      <category term="python" scheme="https://blog.51itzone.cn/categories/Technology/python/"/>
    
    
      <category term="python" scheme="https://blog.51itzone.cn/tags/python/"/>
    
      <category term="pipenv" scheme="https://blog.51itzone.cn/tags/pipenv/"/>
    
  </entry>
  
  <entry>
    <title>è¯¦è§£redisåŠUbuntuçš„å®‰è£…å’Œè¿è¡Œ</title>
    <link href="https://blog.51itzone.cn/2017/10/21/redis-info-install-start-stop/"/>
    <id>https://blog.51itzone.cn/2017/10/21/redis-info-install-start-stop/</id>
    <published>2017-10-21T06:10:25.000Z</published>
    <updated>2018-08-20T02:11:16.649Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†™ä½œç›®çš„"><a href="#å†™ä½œç›®çš„" class="headerlink" title="å†™ä½œç›®çš„"></a>å†™ä½œç›®çš„</h1><ol><li>äº†è§£redisçš„åŠŸèƒ½å’Œç‰¹ç‚¹</li><li>è®°å½•å®‰è£…æ–¹æ³•å’Œæ­¥éª¤ï¼Œæ–¹ä¾¿å¤æŸ¥</li><li>ç¯å¢ƒï¼šubuntu 16.04 LTS redis-4.0.2</li><li>æ¯ä¸ªçŸ¥è¯†ç‚¹èƒŒåéƒ½æœ‰å…¶åŸå› ï¼Œæ·±ç©¶æ‰ä¼šæŒæ¡çŸ¥è¯†çš„æœ¬çœŸ</li></ol><a id="more"></a><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p><a href="https://redis.io/" target="_blank" rel="noopener">Redis</a>ç”±Salvatore Sanfilippoå¼€å‘äº2009å¹´ï¼Œåˆ°ä»Šå¹´9æœˆ21å·å·²ç»å‘å¸ƒäº†197ä¸ª<a href="https://github.com/antirez/redis/releases/" target="_blank" rel="noopener">release</a>ç‰ˆæœ¬ï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæ˜¯4.0.2ã€‚Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSICè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€çµæ´»çš„ã€å¼€æºçš„ã€key-valueå­˜å‚¨ç³»ç»Ÿã€‚å®ƒå…è®¸ç”¨æˆ·å­˜å‚¨å¤§é‡çš„æ•°æ®ï¼Œè€Œä¸”æ²¡æœ‰å…³ç³»æ•°æ®åº“çš„é™åˆ¶ã€‚Rediså’ŒMemcachedç±»ä¼¼ï¼Œä½†æ˜¯è§£å†³äº†æ–­ç”µåæ•°æ®å®Œå…¨ä¸¢å¤±çš„æƒ…å†µ(ç”±äºredisæ˜¯å¼‚æ­¥å¤åˆ¶ï¼Œå› æ­¤ä¸ä¿è¯æ•°æ®å®Œå…¨ä¸ä¸¢å¤±ï¼Œåªæ˜¯è§£å†³äº†ä¸ä¸¢å¤±çš„å¯èƒ½æ€§ï¼‰ï¼Œè€Œä¸”å®ƒæ”¯æŒæ›´å¤šå…ƒåŒ–çš„valueç±»å‹ï¼Œè€Œä¸”æ€§èƒ½ç›¸å¯¹é«˜æ•ˆã€‚åŒæ—¶å®ƒä¹Ÿæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€è°ƒç”¨ï¼šActionScript, C, C++, C#, Chicken Scheme, Clojure, Common Lisp, D, Dart, Erlang, Go, Haskell, Haxe, Io, Java, JavaScript (Node.js), Julia, Lua, Objective-C, OCaml, Perl, PHP, Pure Data, Python, R[16], Racket, Ruby, Rust, Scala, Smalltalk and Tclï¼Œå¹¶ä¸”é€šè¿‡Redis Sentinelæä¾›é«˜å¯ç”¨ï¼Œé€šè¿‡Redis Clusteræä¾›è‡ªåŠ¨åˆ†ç‰‡ã€‚ Redisè¿˜æ”¯æŒä¸»ä»å¼‚æ­¥å¤åˆ¶ï¼Œéå¸¸å¿«çš„éé˜»å¡åˆæ¬¡åŒæ­¥ã€ç½‘ç»œæ–­å¼€æ—¶è‡ªåŠ¨é‡è¿å±€éƒ¨é‡åŒæ­¥ã€‚<br>å…¶ä»–ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>äº‹åŠ¡</li><li>è®¢é˜…/å‘å¸ƒ</li><li>Luaè„šæœ¬</li><li>å¸¦TTLçš„é”®</li><li>LRUå›æ”¶å¥</li><li>è‡ªåŠ¨æ•…éšœè½¬ç§»(failover)</li></ul><h2 id="1ã€æ•°æ®æ¨¡å‹"><a href="#1ã€æ•°æ®æ¨¡å‹" class="headerlink" title="1ã€æ•°æ®æ¨¡å‹"></a>1ã€æ•°æ®æ¨¡å‹</h2><p>ä½œä¸ºKey-valueå‹æ•°æ®åº“ï¼ŒRedisä¹Ÿæä¾›äº†é”®ï¼ˆKeyï¼‰å’Œé”®å€¼ï¼ˆValueï¼‰çš„æ˜ å°„å…³ç³»ã€‚ä½†æ˜¯ï¼Œé™¤äº†å¸¸è§„çš„æ•°å€¼æˆ–å­—ç¬¦ä¸²ï¼ŒRedisçš„é”®å€¼è¿˜å¯ä»¥æ˜¯ä»¥ä¸‹å½¢å¼ï¼š==Lists, Sets, Sorted Sets, Hashes, <a href="https://en.wikipedia.org/wiki/HyperLogLog/" target="_blank" rel="noopener">HyperLogLogs</a>,Bitmaps,<a href="https://en.wikipedia.org/wiki/Geohash/" target="_blank" rel="noopener">Geospatial</a> data(åœ°ç†ç©ºé—´æ•°æ® since Redis 3.2)==ã€‚é”®å€¼çš„æ•°æ®ç±»å‹å†³å®šäº†è¯¥é”®å€¼æ”¯æŒçš„æ“ä½œã€‚Redisæ”¯æŒè¯¸å¦‚åˆ—è¡¨ã€é›†åˆæˆ–æœ‰åºé›†åˆçš„äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰é«˜çº§åŸå­æ“ä½œï¼›åŒæ—¶ï¼Œå¦‚æœé”®å€¼çš„ç±»å‹æ˜¯æ™®é€šæ•°å­—ï¼ŒRedisåˆ™æä¾›è‡ªå¢ç­‰åŸå­æ“ä½œã€‚</p><h2 id="2ã€æŒä¹…åŒ–"><a href="#2ã€æŒä¹…åŒ–" class="headerlink" title="2ã€æŒä¹…åŒ–"></a>2ã€æŒä¹…åŒ–</h2><p>é€šå¸¸ï¼ŒRediså°†æ•°æ®å…¨éƒ¨å­˜å‚¨äºå†…å­˜ä¸­ï¼Œæˆ–è¢«é…ç½®ä¸ºä½¿ç”¨è™šæ‹Ÿå†…å­˜(since Redis 2.3)ï¼Œæ­¤åŠŸèƒ½å·²ç»è¢«å¼ƒç”¨ï¼Œæ¥ä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚<br>ç°åœ¨Rediså¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°æ•°æ®æŒä¹…åŒ–:</p><ol><li>ä½¿ç”¨å¿«ç…§çš„æ–¹å¼ï¼Œå¼‚æ­¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¸æ–­å†™å…¥ç£ç›˜ï¼›</li><li>ä½¿ç”¨AOF(append-only file)(since Redis 1.1)çš„æ–¹å¼ï¼Œç±»ä¼¼MySQLçš„æ—¥å¿—æ–¹å¼ï¼Œä»¥å¢é‡çš„æ–¹å¼è®°å½•æ¯æ¬¡æ›´æ–°çš„æ—¥å¿—ã€‚</li></ol><p>å‰è€…æ€§èƒ½è¾ƒé«˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¼•èµ·ä¸€å®šç¨‹åº¦çš„æ•°æ®ä¸¢å¤±ï¼›åè€…ç›¸åã€‚é»˜è®¤æƒ…å†µä¸‹Redisæ¯2ç§’ä¼šå†™å…¥æ•°æ®åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œå½“ç„¶å¦‚æœéœ€è¦è¿™ä¸ªæ—¶é—´æ˜¯å¯é…ç½®çš„ã€‚å¦‚æœç³»ç»Ÿå®•æœºï¼Œé‚£ä¹ˆåªä¼šæœ‰å‡ ç§’çš„æ•°æ®ä¼šä¸¢å¤±ã€‚å¦‚æœå¯¹æ­¤æ„Ÿå…´è¶£ï¼Œå¯ä»¥é˜…è¯»ä½œè€…çš„åšæ–‡ <a href="http://oldblog.antirez.com/post/redis-persistence-demystified.html/" target="_blank" rel="noopener">Redis persistence demystified</a>æˆ–è€…æ­¤æ–‡<a href="http://powersoft.iteye.com/blog/2147091/" target="_blank" rel="noopener">Rediså®˜æ–¹æ–‡æ¡£(13) â€”â€”æŒä¹…åŒ–</a></p><h2 id="3ã€å¤åˆ¶"><a href="#3ã€å¤åˆ¶" class="headerlink" title="3ã€å¤åˆ¶"></a>3ã€å¤åˆ¶</h2><p>Redisæ”¯æŒå°†æ•°æ®åŒæ­¥åˆ°å¤šå°ä»åº“ä¸Šï¼Œè¿™ç§ç‰¹æ€§å¯¹æé«˜è¯»å–æ€§èƒ½éå¸¸æœ‰ç›Šã€‚Replicationæ˜¯Redisæœ€é‡è¦çš„åŠŸèƒ½ï¼Œä½†ä¹Ÿæ˜¯å‘æœ€å¤šçš„åŠŸèƒ½ï¼Œæƒ³æŒæ¡å¥½ï¼Œéœ€è¦äº†è§£è¿™äº›å†…å®¹ã€‚</p><ul><li>Redis é‡‡ç”¨å¼‚æ­¥å¤åˆ¶(since Redis 2.8)ã€‚ ä¸€ä¸ªä¸»æœåŠ¡å™¨å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æœåŠ¡å™¨ã€‚</li><li>ä»æœåŠ¡å™¨å¯ä»¥æ¥å—å…¶ä»–ä»æœåŠ¡å™¨çš„è¿æ¥ä¼šå½¢æˆ==å›¾çŠ¶ç»“æ„==ã€‚</li><li>Redis çš„å¤åˆ¶åœ¨ä¸»æœåŠ¡å™¨ä¸Šæ˜¯éé˜»å¡çš„ã€‚</li><li>Redis çš„å¤åˆ¶åœ¨ä»æœåŠ¡å™¨ä¸Šä¹Ÿæ˜¯éé˜»å¡çš„ã€‚</li><li>å¤åˆ¶å¯ä»¥ç”¨æ¥æ”¯æŒå¯ä¼¸ç¼©æ€§ï¼Œç”¨å¤šä¸ªä»æœåŠ¡å™¨å¤„ç†åªè¯»æŸ¥è¯¢(ä¾‹å¦‚ï¼Œç¹é‡çš„ SORT æ“ä½œå¯ä»¥åˆ†é…åˆ°ä»æœåŠ¡å™¨ä¸Š)ï¼Œä¹Ÿå¯ä»¥ä»…ä»…ä½œä¸ºæ•°æ®å†—ä½™ã€‚</li></ul><h2 id="4-é«˜å¯ç”¨"><a href="#4-é«˜å¯ç”¨" class="headerlink" title="4 é«˜å¯ç”¨"></a>4 é«˜å¯ç”¨</h2><p>Redis Sentinel æ˜¯ Redis çš„å®˜æ–¹é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆï¼Œæ˜¯è®¾è®¡ç”¨æ¥å¸®åŠ©ç®¡ç† Redis å®ä¾‹çš„ç³»ç»Ÿã€‚ç”¨äºå®Œæˆä¸‹é¢ 4 ä¸ªä»»åŠ¡ï¼š</p><ul><li>ç›‘æ§(Monitoring)ã€‚Sentinel ä¸æ–­æ£€æŸ¥ä½ çš„ä¸»ä»å®ä¾‹æ˜¯å¦è¿è½¬æ­£å¸¸ã€‚</li><li>é€šçŸ¥(Notification)ã€‚Sentinel å¯ä»¥é€šè¿‡ API æ¥é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ–è€…å…¶ä»–è®¡ç®—æœºç¨‹åºï¼Œè¢«ç›‘æ§çš„ Redis å®ä¾‹å‡ºäº†é—®é¢˜ã€‚</li><li>è‡ªåŠ¨æ•…éšœè½¬ç§»(Automatic failover)ã€‚å¦‚æœä¸€å°ä¸»æœåŠ¡å™¨è¿è¡Œä¸æ­£å¸¸ï¼ŒSentinelä¼šå¼€å§‹ä¸€ä¸ªæ•…éšœè½¬ç§»è¿‡ç¨‹ï¼Œå°†ä»æœåŠ¡å™¨æå‡ä¸ºä¸»æœåŠ¡å™¨ï¼Œé…ç½®å…¶ä»–çš„ä»æœåŠ¡å™¨ä½¿ç”¨æ–°çš„ä¸»æœåŠ¡å™¨ï¼Œä½¿ç”¨ Redis æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºåœ¨è¿æ¥æ—¶ä¼šæ”¶åˆ°æ–°çš„æœåŠ¡å™¨åœ°å€é€šçŸ¥ã€‚</li><li>é…ç½®æä¾›è€…(Configuration provider)ã€‚Sentinel å……å½“å®¢æˆ·ç«¯æœåŠ¡å‘ç°çš„æƒå¨æ¥æºï¼šå®¢æˆ·ç«¯è¿æ¥åˆ° Sentinel æ¥è¯¢é—®æŸä¸ªæœåŠ¡çš„å½“å‰ Redisä¸»æœåŠ¡å™¨çš„åœ°å€ã€‚å½“æ•…éšœè½¬ç§»å‘ç”Ÿæ—¶ï¼ŒSentinel ä¼šæŠ¥å‘Šæ–°åœ°å€ã€‚</li></ul><h2 id="5-é›†ç¾¤"><a href="#5-é›†ç¾¤" class="headerlink" title="5 é›†ç¾¤"></a>5 é›†ç¾¤</h2><p>æ”¯æŒåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæˆä¸ºRedisèƒ½æŒç»­ä¸æ–­å‘å±•çš„åŠ¨åŠ›ï¼Œä¹Ÿæ˜¯èƒ½è¢«å¹¿æ³›ä½¿ç”¨çš„äº®ç‚¹ã€‚æˆ‘ä»¬çœ‹çœ‹redisé›†ç¾¤éƒ½èƒ½åšä»€ä¹ˆ</p><ul><li>Redis é›†ç¾¤æä¾›ä¸€ç§è¿è¡Œ Redis çš„æ–¹å¼ï¼Œæ•°æ®è¢«è‡ªåŠ¨çš„åˆ†ç‰‡åˆ°å¤šä¸ª Redis èŠ‚ç‚¹ã€‚</li><li>é›†ç¾¤ä¸æ”¯æŒå¤„ç†å¤šä¸ªé”®çš„å‘½ä»¤ï¼Œå› ä¸ºè¿™éœ€è¦åœ¨ Redis èŠ‚ç‚¹é—´ç§»åŠ¨æ•°æ®ï¼Œä½¿å¾— Redis é›†ç¾¤ä¸èƒ½æä¾›åƒ Redis å•ç‚¹é‚£æ ·çš„æ€§èƒ½ï¼Œåœ¨é«˜è´Ÿè½½ä¸‹ä¼šè¡¨ç°å¾—ä¸å¯é¢„çŸ¥ã€‚</li><li>Redis é›†ç¾¤ä¹Ÿæä¾›åœ¨ç½‘ç»œåˆ†å‰²ï¼ˆpartitionsï¼‰æœŸé—´çš„ä¸€å®šç¨‹åº¦çš„å¯ç”¨æ€§ï¼Œè¿™å°±æ˜¯åœ¨ç°å®ä¸­å½“ä¸€äº›èŠ‚ç‚¹å¤±è´¥æˆ–è€…ä¸èƒ½é€šä¿¡æ—¶èƒ½ç»§ç»­è¿›è¡Œè¿è½¬çš„èƒ½åŠ›ã€‚</li></ul><p>å½“ç„¶ä¸Šæ–‡åªæ˜¯å¯¹ Redis åŠŸèƒ½çš„ä¸€ä¸ªæ¦‚è§ˆï¼Œå¦‚æœæƒ³æ·±å…¥å­¦ä¹ ï¼Œæ¯ä¸ªç‰¹æ€§éƒ½å¯ä»¥å†™ä¸€ç³»åˆ—æ–‡ç« ï¼Œæœ¬æ–‡å°±ä¸å†è¯¦ç»†å±•å¼€å™è¿°ã€‚</p><h1 id="å®‰è£…åŠè¿è¡Œ-redis"><a href="#å®‰è£…åŠè¿è¡Œ-redis" class="headerlink" title="å®‰è£…åŠè¿è¡Œ redis"></a>å®‰è£…åŠè¿è¡Œ redis</h1><h2 id="1ã€æ£€æµ‹æ˜¯å¦æœ‰å®‰è£…redis"><a href="#1ã€æ£€æµ‹æ˜¯å¦æœ‰å®‰è£…redis" class="headerlink" title="1ã€æ£€æµ‹æ˜¯å¦æœ‰å®‰è£…redis"></a>1ã€æ£€æµ‹æ˜¯å¦æœ‰å®‰è£…redis</h2><p>ä½¿ç”¨linuxå‘½ä»¤ <a href="http://man.linuxde.net/whereis/" target="_blank" rel="noopener">whereis</a> æŸ¥æ‰¾æ˜¯å¦å®‰è£… redis-cli å’Œ redis-server</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ubuntu-linux:~$ whereis redis-cli</span><br><span class="line">redis-cli:</span><br><span class="line"></span><br><span class="line">ubuntu@ubuntu-linux:~$ whereis redis-server</span><br><span class="line">redis-server:</span><br></pre></td></tr></table></figure><h2 id="2ã€å®‰è£…-Redis"><a href="#2ã€å®‰è£…-Redis" class="headerlink" title="2ã€å®‰è£… Redis"></a>2ã€å®‰è£… Redis</h2><h3 id="é€šè¿‡-apt-get-å‘½ä»¤å®‰è£…"><a href="#é€šè¿‡-apt-get-å‘½ä»¤å®‰è£…" class="headerlink" title="é€šè¿‡ apt-get å‘½ä»¤å®‰è£…"></a>é€šè¿‡ apt-get å‘½ä»¤å®‰è£…</h3><ul><li>å‘½ä»¤ï¼š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install redis-server</span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…è¿›è¡Œå®‰è£…å¹¶è§£å‹"><a href="#é€šè¿‡ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…è¿›è¡Œå®‰è£…å¹¶è§£å‹" class="headerlink" title="é€šè¿‡ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…è¿›è¡Œå®‰è£…å¹¶è§£å‹"></a>é€šè¿‡ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…è¿›è¡Œå®‰è£…å¹¶è§£å‹</h3><ul><li>æœ¬æ–‡ä¸æ˜¯ç”¨ root ç”¨æˆ·å®‰è£…</li><li>å‘½ä»¤ï¼š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-4.0.2.tar.gz</span><br><span class="line">tar -zxvf redis-4.0.2.tar.gz</span><br></pre></td></tr></table></figure><ul><li>ç§»åˆ°è§£å‹åçš„ Redis åˆ°/usr/local/redis-4.0.2</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mv redis-4.0.2 /usr/local/</span><br></pre></td></tr></table></figure><ul><li>ç¼–è¯‘ä»¥åŠå®‰è£…</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis-4.0.2</span><br><span class="line">make</span><br><span class="line">suod make install</span><br></pre></td></tr></table></figure><h2 id="3ã€å¯åŠ¨-Redis"><a href="#3ã€å¯åŠ¨-Redis" class="headerlink" title="3ã€å¯åŠ¨ Redis"></a>3ã€å¯åŠ¨ Redis</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/bin/redis-server</span><br></pre></td></tr></table></figure><p>==æ³¨æ„ï¼šé root å¯åŠ¨,å¦‚æœç”¨å‘½ä»¤ç›´æ¥å…³é—­redisï¼Œredisæ— æ³•ç»“æŸè¿›ç¨‹==</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">11462:M 21 Nov 17:15:54.777 # User requested shutdown...</span><br><span class="line">11462:M 21 Nov 17:15:54.777 * Saving the final RDB snapshot before exiting.</span><br><span class="line">11462:M 21 Nov 17:15:54.777 # Failed opening the RDB file dump.rdb (in server root dir /usr/local/bin) for saving: Permission denied</span><br><span class="line">11462:M 21 Nov 17:15:54.777 # Error trying to save the DB, can't exit.</span><br></pre></td></tr></table></figure><ul><li>æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sudo /usr/local/bin/redis-server /usr/local/redis-4.0.2/redis.conf &amp;</span><br></pre></td></tr></table></figure><ul><li>æ£€æµ‹åå°è¿›ç¨‹æ˜¯å¦å­˜åœ¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef |grep redis</span><br></pre></td></tr></table></figure><ul><li>æ£€æµ‹ 6379 ç«¯å£æ˜¯å¦åœ¨ç›‘å¬</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -lntp | grep 6379</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ redis-cli è¿›è¡Œè¿æ¥</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ubuntu-linux:/usr/local/bin$ redis-cli</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">127.0.0.1:6379&gt; set redis redis-4.0.2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get redis</span><br><span class="line">"redis-4.0.2"</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure><h2 id="4ã€åœæ­¢-Redis"><a href="#4ã€åœæ­¢-Redis" class="headerlink" title="4ã€åœæ­¢ Redis"></a>4ã€åœæ­¢ Redis</h2><ul><li>ä½¿ç”¨ redis-cli åœæ­¢</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli shutdown</span><br></pre></td></tr></table></figure><ul><li>æˆ–åœ¨ redis-cli å‘½ä»¤è¡Œä¸­åœæ­¢</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt;</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥ kill æ‰è¿›ç¨‹ï¼ˆ Redis å¯ä»¥å¦¥å–„å¤„ç† SIGTERM ä¿¡å·ï¼‰</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 PID</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Redis æ˜¯å¼€å‘äººå‘˜å¿…å¤‡çš„åˆ©å™¨ï¼ŒæŒæ¡å¥½ Redis çš„åŠŸèƒ½ç‰¹æ€§å¹¶ä½¿ç”¨åˆ°å®é™…åœºæ™¯æ‰èƒ½çœŸæ­£ä½“ä¼šåˆ° Redis çš„å¸¦æ¥çš„ä¾¿åˆ©ã€‚ç›®å‰ Redis ä¸»è¦åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p><ul><li>æ„å»ºé«˜å¯ç”¨çš„ç¼“å­˜ç³»ç»Ÿ</li><li>ç§¯åˆ†æ’è¡Œæ¦œï¼ˆ sorted set ï¼‰</li><li>è®¡æ•°å™¨</li><li>åˆ†å¸ƒå¼é”</li><li>æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆ message queue / pub/sub)</li><li>webæœåŠ¡å™¨çš„sessionç®¡ç†</li></ul><blockquote><p>å‚è€ƒèµ„æ–™</p><ol><li><a href="https://redis.io/documentation/" target="_blank" rel="noopener">Redis</a></li><li><a href="https://en.wikipedia.org/wiki/Redis/" target="_blank" rel="noopener">Redis wikipedia</a></li><li><a href="https://github.com/JasonLai256/the-little-redis-book/blob/dcb68a2a1cbf1a4e328dc5eb980f4f525ab291c6/cn/redis.md" target="_blank" rel="noopener">the-little-redis-book</a></li><li><a href="http://www.iteye.com/blogs/subjects/redis3/" target="_blank" rel="noopener">Redis3.0å®˜æ–¹æ–‡æ¡£ç¿»è¯‘å’Œæºç è§£æ</a></li></ol></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å†™ä½œç›®çš„&quot;&gt;&lt;a href=&quot;#å†™ä½œç›®çš„&quot; class=&quot;headerlink&quot; title=&quot;å†™ä½œç›®çš„&quot;&gt;&lt;/a&gt;å†™ä½œç›®çš„&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;äº†è§£redisçš„åŠŸèƒ½å’Œç‰¹ç‚¹&lt;/li&gt;
&lt;li&gt;è®°å½•å®‰è£…æ–¹æ³•å’Œæ­¥éª¤ï¼Œæ–¹ä¾¿å¤æŸ¥&lt;/li&gt;
&lt;li&gt;ç¯å¢ƒï¼šubuntu 16.04 LTS redis-4.0.2&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªçŸ¥è¯†ç‚¹èƒŒåéƒ½æœ‰å…¶åŸå› ï¼Œæ·±ç©¶æ‰ä¼šæŒæ¡çŸ¥è¯†çš„æœ¬çœŸ&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://blog.51itzone.cn/categories/Technology/"/>
    
      <category term="Redis" scheme="https://blog.51itzone.cn/categories/Technology/Redis/"/>
    
    
      <category term="Ubuntu" scheme="https://blog.51itzone.cn/tags/Ubuntu/"/>
    
      <category term="redis" scheme="https://blog.51itzone.cn/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>LinkedList å®ç°åˆ†æåŠä½¿ç”¨</title>
    <link href="https://blog.51itzone.cn/2016/02/26/linkedlist-analysis-and-use/"/>
    <id>https://blog.51itzone.cn/2016/02/26/linkedlist-analysis-and-use/</id>
    <published>2016-02-26T10:46:00.000Z</published>
    <updated>2018-08-20T02:11:16.648Z</updated>
    
    <content type="html"><![CDATA[<p>jdkä¸­çš„ç»å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯ç»è¿‡åƒé”¤ç™¾ç‚¼çš„ï¼Œä»£ç è´¨é‡éå¸¸ä¹‹é«˜ï¼Œåœ¨äº†è§£å…¶åº•å±‚å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜ç¼–ç è§„èŒƒï¼Œå…»æˆè‰¯å¥½çš„ä¹ æƒ¯ã€‚çŸ¥è¯†åœ¨äºæ€»ç»“å’Œåˆ©ç”¨ï¼ŒåŸºç¡€çŸ¥è¯†çš„å®Œå–„ä¼šè®©å·¥ä½œå˜æ›´åŠ è½»æ¾ã€‚æœ¬æ–‡é€šè¿‡åˆ†æ LinkedList çš„åº•å±‚å®ç°æ¥å­¦ä¹  LinkdedList çš„ä½¿ç”¨ã€‚<br><a id="more"></a></p><h1 id="LinkedList-å®ç°åˆ†æ"><a href="#LinkedList-å®ç°åˆ†æ" class="headerlink" title="LinkedList å®ç°åˆ†æ"></a>LinkedList å®ç°åˆ†æ</h1><p><a href="https://en.wikipedia.org/wiki/Linked_list" target="_blank" rel="noopener">LinkedList</a> æ˜¯å®ç° list çš„çº¿æ€§å­˜å‚¨ç»“æ„çš„ä¸€ä¸ªé‡è¦çš„å®ç°ç±»ï¼ŒLinkedList æ˜¯é€šè¿‡é“¾è¡¨çš„å½¢å¼å­˜æ”¾æ•°æ®ï¼Œè€ŒArrayListå’ŒVectoræ˜¯é€šè¿‡æ•°ç»„å­˜å‚¨çš„é¡ºåºç»“æ„ã€‚å½“ç„¶ï¼Œ LinkedList ä¹Ÿæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨åæ–‡è¯´æ˜å¦‚ä½•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨å®ƒã€‚</p><h1 id="LinkedListå…·ä½“å®ç°ç±»å›¾å¦‚ä¸‹ï¼š"><a href="#LinkedListå…·ä½“å®ç°ç±»å›¾å¦‚ä¸‹ï¼š" class="headerlink" title="LinkedListå…·ä½“å®ç°ç±»å›¾å¦‚ä¸‹ï¼š"></a>LinkedListå…·ä½“å®ç°ç±»å›¾å¦‚ä¸‹ï¼š</h1><p><img src="/images/post/2016/02/linked_list.png" alt="LinkedList ç±»ç»§æ‰¿å…³ç³»"></p><p>é€šè¿‡å›¾ä¸­çš„æˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ° <code>LinkedList</code> å³å®ç°äº† <code>list</code> æ¥å£åˆå®ç°äº† <code>Deque</code> æ¥å£ã€‚é‚£è¯´æ˜ LinkedList å…·æœ‰æ‰€æœ‰ list çš„åŠŸèƒ½åŒæ—¶ï¼Œè¿˜å…·å¤‡é˜Ÿåˆ—çš„åŠŸèƒ½ã€‚é€šè¿‡é˜…è¯» JDK çš„æºç æ–‡æ¡£ï¼Œæˆ‘ä»¬å‘ç° LinkedList æ˜¯åŸºäºåŒå‘é˜Ÿåˆ—çš„æ•°æ®ç»“æ„å®ç°çš„ ï¼ˆ<a href="https://en.wikipedia.org/wiki/Doubly_linked_list" target="_blank" rel="noopener">Doubly-linked list</a>ï¼‰ã€‚</p><p>å…·ä½“ç»“æ„æˆ‘ä»¬å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š</p><p><img src="/images/post/2016/02/double_linked_list.jpg" alt="åŒå‘é“¾è¡¨æ•°æ®ç»“æ„"></p><h1 id="åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„"><a href="#åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„" class="headerlink" title="åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„"></a>åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„</h1><p><code>LinkedList</code> æ˜¯é€šè¿‡<a href="https://zh.wikipedia.org/wiki/%E9%93%BE%E8%A1%A8" target="_blank" rel="noopener">é“¾è¡¨</a>ç»“æ„æ¥å­˜å‚¨æ•°æ®,è€Œä¸”å®ç°çš„æ˜¯åŒå‘é“¾è¡¨ã€‚åŒå‘é“¾è¡¨æ˜¯æ•°æ®ç»“æ„çš„ä¸€ç§å½¢å¼ï¼Œä»–çš„æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆï¼Œ prev æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œnext æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚è¿™ç§ç»“æ„æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿä»–å¯ä»¥å®ç°åŒå‘éå†ï¼Œè¿™ä½¿å¾—åœ¨é“¾è¡¨ä¸­çš„æ•°æ®è¯»å–å˜å¾—éå¸¸çµæ´»è‡ªç”±ã€‚åŒæ—¶ï¼ŒLinkedList ä¸­ç»´æŠ¤äº†ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘å¤´éƒ¨ï¼Œä¸€ä¸ªæŒ‡å‘å°¾éƒ¨ã€‚ç»´æŠ¤è¿™ä¸¤ä¸ªæŒ‡é’ˆåï¼Œå¯ä»¥ä½¿å¾—å…ƒç´ ä»å¤´éƒ¨æ’å…¥ï¼Œä¹Ÿå¯ä»¥ä½¿å…ƒç´ ä»å°¾éƒ¨æ’å…¥ã€‚åŸºäºæ–¹å¼ï¼Œç”¨æˆ·å¾ˆå®¹æ˜“å°±èƒ½å®ç° FIFO(é˜Ÿåˆ—)ï¼Œ LIFO(æ ˆ)ç­‰æ•ˆæœã€‚é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç ä¸­çš„å…·ä½“å®ç°ã€‚</p><h2 id="Nodeå®šä¹‰"><a href="#Nodeå®šä¹‰" class="headerlink" title="Nodeå®šä¹‰"></a>Nodeå®šä¹‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LinkedListåˆ—è¡¨çš„æ–°å¢"><a href="#LinkedListåˆ—è¡¨çš„æ–°å¢" class="headerlink" title="LinkedListåˆ—è¡¨çš„æ–°å¢"></a>LinkedListåˆ—è¡¨çš„æ–°å¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Links e as last element.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(l, e, <span class="keyword">null</span>);</span><br><span class="line">    last = newNode;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        l.next = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯è§æ¯æ¬¡æ’å…¥éƒ½æ˜¯ç§»åŠ¨å¼•ç”¨ï¼Œå’Œ ArrayList çš„æ‹·è´æ•°ç»„æ¥è¯´æ•ˆç‡è¦é«˜ä¸Šä¸å°‘ã€‚</p><h2 id="LinkedListåˆ—è¡¨çš„æŸ¥è¯¢"><a href="#LinkedListåˆ—è¡¨çš„æŸ¥è¯¢" class="headerlink" title="LinkedListåˆ—è¡¨çš„æŸ¥è¯¢"></a>LinkedListåˆ—è¡¨çš„æŸ¥è¯¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    <span class="keyword">return</span> node(index).item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node&lt;E&gt; <span class="title">node</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert isElementIndex(index);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;</span><br><span class="line">        Node&lt;E&gt; x = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">            x = x.next;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;E&gt; x = last;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = size - <span class="number">1</span>; i &gt; index; i--)</span><br><span class="line">            x = x.prev;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>LinkedListä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥çœ‹ <code>index</code> ç¦» size ä¸­é—´è·ç¦»æ¥åˆ¤æ–­æ˜¯ä»å¤´ç»“ç‚¹æ­£åºæŸ¥è¿˜æ˜¯ä»å°¾èŠ‚ç‚¹å€’åºæŸ¥ã€‚è¿™æ ·çš„æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œç‰¹åˆ«æ˜¯å½“ index è·ç¦» size çš„ä¸­é—´ä½ç½®è¶Šè¿œæ—¶ã€‚</p><h2 id="LinkedList-è¿­ä»£å®ç°"><a href="#LinkedList-è¿­ä»£å®ç°" class="headerlink" title="LinkedList è¿­ä»£å®ç°"></a>LinkedList è¿­ä»£å®ç°</h2><p>LinkedList çš„è¿­ä»£å™¨å®ç°æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å®ç°äº†Iteratoræ¥å£çš„DescendingIteratorï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯å®ç°äº† ListIterator æ¥å£çš„ ListItr ã€‚</p><h3 id="ListItr-å®ç°"><a href="#ListItr-å®ç°" class="headerlink" title="ListItr å®ç°"></a>ListItr å®ç°</h3><p>ListItréå†éœ€è¦æŒ‡å®šä¸€ä¸ªèµ·å§‹å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    checkPositionIndex(index);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ListItr ä¼šåˆ›å»ºä¸€ä¸ªä»¥ index ä¸ºèµ·å§‹å€¼çš„è¿­ä»£å™¨ï¼Œç„¶åç”¨æˆ·ä¾¿å¯ä»¥ä»¥è¿™ä¸ªä½ç½®ä¸ºèµ·ç‚¹ï¼Œå®ç°å‘å‰æˆ–è€…å‘åéå†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ListItr(<span class="keyword">int</span> index) &#123;</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå°†nextæŒ‡é’ˆæŒ‡å‘æŒ‡å®šä½ç½®çš„å…ƒç´ </span></span><br><span class="line">    next = (index == size) ? <span class="keyword">null</span> : node(index);</span><br><span class="line">    nextIndex = index;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘åéå†</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="keyword">if</span> (!hasNext())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line"></span><br><span class="line">    lastReturned = next;</span><br><span class="line">    next = next.next;</span><br><span class="line">    nextIndex++;</span><br><span class="line">    <span class="keyword">return</span> lastReturned.item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å‰éå†</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="keyword">if</span> (!hasPrevious())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line"></span><br><span class="line">    lastReturned = next = (next == <span class="keyword">null</span>) ? last : next.prev;</span><br><span class="line">    nextIndex--;</span><br><span class="line">    <span class="keyword">return</span> lastReturned.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="DescendingIterator-å®ç°"><a href="#DescendingIterator-å®ç°" class="headerlink" title="DescendingIterator å®ç°"></a>DescendingIterator å®ç°</h3><p>DescendingIterator è¿­ä»£å™¨å®ç°çš„æ˜¯å¯¹é“¾è¡¨ä»å°¾éƒ¨å‘å¤´éƒ¨éå†çš„åŠŸèƒ½ï¼Œä»–å¤ç”¨äº†ListIträ¸­çš„previousæ–¹æ³•ï¼Œå°†å½“å‰ä½ç½®æŒ‡å‘é“¾è¡¨å°¾éƒ¨ï¼Œç„¶åé€ä¸ªå‘å‰éå†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DescendingIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ListItr itr = <span class="keyword">new</span> ListItr(size());</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> itr.hasPrevious();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> itr.previous();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        itr.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="LinkedList-çš„é˜Ÿåˆ—å®ç°"><a href="#LinkedList-çš„é˜Ÿåˆ—å®ç°" class="headerlink" title="LinkedList çš„é˜Ÿåˆ—å®ç°"></a>LinkedList çš„é˜Ÿåˆ—å®ç°</h1><p>ä»å›¾1æˆ‘ä»¬å¯ä»¥å‘ç° LinkedList å®ç°äº† Deque æ¥å£ï¼Œä»¥ä¸‹æˆ‘ä»¬å¯ä»¥ä»å®ç°é˜Ÿåˆ—çš„åŠŸèƒ½æ¥çœ‹ LinkedList çš„æºç </p><h2 id="LikedList-çš„-FIFO-é˜Ÿåˆ—çš„å®ç°"><a href="#LikedList-çš„-FIFO-é˜Ÿåˆ—çš„å®ç°" class="headerlink" title="LikedList çš„ FIFO é˜Ÿåˆ—çš„å®ç°"></a>LikedList çš„ FIFO é˜Ÿåˆ—çš„å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¥é˜ŸåŠŸèƒ½ï¼Œå…¥å°¾</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨é˜Ÿåˆ—å°¾éƒ¨å¢åŠ ä¸€æ¡è®°å½•ï¼Œå»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> add(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offerLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    addLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨é˜Ÿåˆ—å°¾éƒ¨å¢åŠ ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•åŒ…è£…ï¼ŒåŒæ ·è°ƒç”¨äº†linkLastçš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°† prev æŒ‡é’ˆæŒ‡å‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(l, e, <span class="keyword">null</span>);</span><br><span class="line">    last = newNode;</span><br><span class="line">    <span class="comment">//å°†lastæŒ‡é’ˆæŒ‡å‘æ–°åˆ›å»ºçš„è¿™ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">//å¦‚æœå½“å‰é“¾è¡¨ä¸ºç©ºï¼Œé‚£ä¹ˆå°†å¤´æŒ‡é’ˆä¹ŸæŒ‡å‘è¿™ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">//å°†é“¾è¡¨çš„å°¾èŠ‚ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘æ–°å»ºçš„èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å®Œæ•´çš„å®ç°äº†åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ çš„åŠŸèƒ½</span></span><br><span class="line">        l.next = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡ºé˜ŸåŠŸèƒ½ï¼Œä»å°¾å‡ºé˜Ÿ</span></span><br><span class="line"><span class="comment">//åœ¨é˜Ÿåˆ—å¤´éƒ¨å–å‡ºä¸€ä¸ªå…ƒç´ å¹¶åˆ é™¤ï¼Œ é˜Ÿåˆ—æ“ä½œå»ºè®®ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">poll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkFirst(f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒä¸Šï¼Œéƒ½è°ƒç”¨äº† unlinkFirst æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pollFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkFirst(f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert f == first &amp;&amp; f != null;</span></span><br><span class="line">    <span class="keyword">final</span> E element = f.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    f.item = <span class="keyword">null</span>;</span><br><span class="line">    f.next = <span class="keyword">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    first = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>)</span><br><span class="line">        last = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        next.prev = <span class="keyword">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LinkedList-çš„-LIFO-æ ˆ-å®ç°"><a href="#LinkedList-çš„-LIFO-æ ˆ-å®ç°" class="headerlink" title="LinkedList çš„ LIFO (æ ˆ)å®ç°"></a>LinkedList çš„ LIFO (æ ˆ)å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨é“¾è¡¨çš„å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    addFirst(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addFirst è°ƒç”¨çš„å°±æ˜¯ linkFirst ï¼Œè¿™æ®µä»£ç å°±æ˜¯å®ç°å°†å…ƒç´ æ·»åŠ çš„é“¾è¡¨å¤´éƒ¨ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">linkFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°å…ƒç´ ï¼Œå°†å…ƒç´ çš„ next æŒ‡é’ˆæŒ‡å‘å½“å‰çš„å¤´ç»“ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(<span class="keyword">null</span>, e, f);</span><br><span class="line">    <span class="comment">// å°†å¤´æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line">    first = newNode;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™æŠŠå°¾æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line">        last = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// å°†å½“å‰å¤´ç»“ç‚¹çš„ prev æŒ‡é’ˆæŒ‡å‘æ­¤ç»“ç‚¹ã€‚</span></span><br><span class="line">        f.prev = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼¹å‡ºé¡¶éƒ¨ç»“ç‚¹ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> removeFirst();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeFirst è°ƒç”¨çš„å°±æ˜¯ unlinkFirstï¼ŒunlinkFirst å®ç°å°†é“¾è¡¨é¡¶éƒ¨å…ƒç´ åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert f == first &amp;&amp; f != null;</span></span><br><span class="line">    <span class="keyword">final</span> E element = f.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    f.item = <span class="keyword">null</span>;</span><br><span class="line">    f.next = <span class="keyword">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    first = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>)</span><br><span class="line">        last = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        next.prev = <span class="keyword">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é¡¶éƒ¨ç»“ç‚¹ï¼Œä½†æ˜¯ä¸åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : f.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><ul><li>å…‹æœæ•°ç»„é“¾è¡¨éœ€è¦é¢„å…ˆçŸ¥é“æ•°æ®å¤§å°çš„ç¼ºç‚¹ã€‚</li><li>å¯ä»¥å……åˆ†åˆ©ç”¨è®¡ç®—æœºå†…å­˜ç©ºé—´ï¼Œå®ç°çµæ´»çš„å†…å­˜åŠ¨æ€ç®¡ç†ã€‚</li><li>LinkedList æ’å…¥ï¼Œåˆ é™¤éƒ½æ˜¯ç§»åŠ¨å¼•ç”¨æ•ˆç‡å¾ˆé«˜ã€‚</li><li>æŸ¥æ‰¾éœ€è¦è¿›è¡Œéå†æŸ¥è¯¢ï¼Œæ•ˆç‡è¾ƒä½ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;jdkä¸­çš„ç»å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯ç»è¿‡åƒé”¤ç™¾ç‚¼çš„ï¼Œä»£ç è´¨é‡éå¸¸ä¹‹é«˜ï¼Œåœ¨äº†è§£å…¶åº•å±‚å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜ç¼–ç è§„èŒƒï¼Œå…»æˆè‰¯å¥½çš„ä¹ æƒ¯ã€‚çŸ¥è¯†åœ¨äºæ€»ç»“å’Œåˆ©ç”¨ï¼ŒåŸºç¡€çŸ¥è¯†çš„å®Œå–„ä¼šè®©å·¥ä½œå˜æ›´åŠ è½»æ¾ã€‚æœ¬æ–‡é€šè¿‡åˆ†æ LinkedList çš„åº•å±‚å®ç°æ¥å­¦ä¹  LinkdedList çš„ä½¿ç”¨ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://blog.51itzone.cn/categories/Technology/"/>
    
      <category term="Java" scheme="https://blog.51itzone.cn/categories/Technology/Java/"/>
    
    
      <category term="Java" scheme="https://blog.51itzone.cn/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>ArrayList &amp; Vector å®ç°åˆ†æ</title>
    <link href="https://blog.51itzone.cn/2016/02/20/ArrayList-Vector-analysis/"/>
    <id>https://blog.51itzone.cn/2016/02/20/ArrayList-Vector-analysis/</id>
    <published>2016-02-20T10:46:00.000Z</published>
    <updated>2018-08-20T02:11:16.647Z</updated>
    
    <content type="html"><![CDATA[<p>é€šè¿‡é˜…è¯» ArrayList ä¸ Verctor çš„æºç æˆ‘ä»¬å‘ç°ï¼Œå®ƒä»¬çš„ä»£ç å®ç°è¿‘ä¼¼åº¦å‡ ä¹åœ¨90%ã€‚æ‰€ä»¥æˆ‘æŠŠå®ƒä»¬ä¸¤ä¸ªåˆå¹¶èµ·æ¥è¿›è¡Œè¯´æ˜ï¼Œç»†å¿ƒçš„è¯»è€…å¯ä»¥è‡ªè¡Œå»IDEä¸­é˜…è¯»ï¼Œæ¯”å¯¹ä»–ä»¬çš„å®ç°ç»“æ„ã€‚æœ¬æ–‡ä¸»è¦ç»“åˆ JDK8 æºç ä»‹ç»äº† ArrayList å’Œ Vector çš„åˆ›å»ºã€å¢ã€åˆ ã€æ”¹ä»¥åŠé›†åˆçš„è¿­ä»£å’Œ fail-fast æœºåˆ¶ï¼Œå¹¶è¯´æ˜äº†åœ¨æ“ä½œå­é›†çš„ä¸€äº›æ³¨æ„äº‹é¡¹åŠåŸå› ã€‚</p><blockquote><p>æ— ç‰¹åˆ«è¯´æ˜ï¼ŒJDK æºç è®²è§£éƒ½æ˜¯åŸºäº JDK8 è¿›è¡Œçš„åˆ†æã€‚<br><a id="more"></a></p></blockquote><h1 id="ArrayList-å’Œ-Vector-çš„å¼‚åŒ"><a href="#ArrayList-å’Œ-Vector-çš„å¼‚åŒ" class="headerlink" title="ArrayList å’Œ Vector çš„å¼‚åŒ"></a>ArrayList å’Œ Vector çš„å¼‚åŒ</h1><p>åœ¨è®²å®ƒä»¬çš„å¼‚åŒç‚¹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ ArrayList å’Œ Vector çš„ç»§æ‰¿ç»“æ„å›¾<br><img src="/images/post/2016/02/array_list.jpg" alt="ArrayList ç±»ç»§æ‰¿å…³ç³»"> <img src="/images/post/2016/02/vector.jpg" alt="Vector ç±»ç»§æ‰¿å…³ç³»"></p><h2 id="ç›¸åŒç‚¹"><a href="#ç›¸åŒç‚¹" class="headerlink" title="ç›¸åŒç‚¹"></a>ç›¸åŒç‚¹</h2><ol><li>éƒ½æ˜¯<strong>æœ‰åº</strong>çš„ï¼Œæ’å…¥å…ƒç´ å¯é‡å¤ï¼Œæ”¯æŒæ’å…¥ null ï¼Œæ”¯æŒéšæœºè®¿é—®ã€‚</li><li>ä»ä¸Šå›¾å¯ä»¥å‘ç° ArrayList å’Œ Vector ç»§æ‰¿äº†ç›¸åŒçš„çˆ¶ç±»å’Œå®ç°äº†ç›¸åŒçš„æ¥å£ï¼Œæ‰€ä»¥æä¾›çš„åŠŸèƒ½ä¹ŸåŸºæœ¬ç›¸åŒã€‚</li><li>é›†åˆä¸­ç»´æŠ¤çš„éƒ½æ˜¯ Object ç±»å‹çš„æ•°ç»„ï¼Œé€šè¿‡æ³›å‹æ–¹å¼æ¥æŒ‡å®šæ•°ç»„çš„ç±»å‹ã€‚</li><li>åˆå§‹å¦‚æœæ²¡æœ‰æŒ‡å®šé›†åˆçš„é•¿åº¦å¤§å°ï¼Œåˆ™é›†åˆé»˜è®¤æ•°ç»„é•¿åº¦éƒ½ä¸º10ã€‚</li><li>éƒ½å®ç°äº† Iterator å’Œ ListIterator æ¥å£ï¼Œæ‰€ä»¥å…·æœ‰ç›¸åŒçš„éå†æ–¹å¼ã€‚</li><li>ArrayList å’Œ Vector éƒ½å…·æœ‰åŠ¨æ€æ‰©å®¹çš„ç‰¹æ€§ã€‚</li></ol><h2 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h2><ol><li>Vector çš„å®ç°æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºæ“ä½œé›†åˆçš„æ–¹æ³•ä½¿ç”¨äº†å…³é”®å­— <strong>Synchronized</strong> ï¼Œè€Œä½¿ç”¨çº¿ç¨‹åŒæ­¥çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¤§å¹¶å‘ä¸‹ï¼Œæ“ä½œé›†åˆç¨‹åºæ€§èƒ½ä¼šä¸¥é‡é™ä½ï¼Œè€Œ ArrayList çš„å®ç°æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„æƒ…å†µï¼Œå°½é‡ä½¿ç”¨ ArrayListã€‚</li><li>å½“ ArrayList å’Œ Vector çš„å¤§å°è¶…è¿‡å½“å‰æ‰€èƒ½å®¹çº³å…ƒç´ çš„æ•°ç»„å¤§å°æ—¶ï¼ŒArrayList ä¼šæ‰©å¤§ä¸ºå½“å‰æ•°ç»„çš„ 50% æ¥å®¹çº³æ–°å…ƒç´ ï¼Œè€Œ Vectorä¸­æœ‰ä¸€ä¸ª<code>capacityIncrement</code> å˜é‡ï¼Œå¦‚æœ capacityIncrement &gt; 0, åˆ™æ¯æ¬¡æ‰©å®¹éƒ½åœ¨åŸæ¥å¤§å°åŸºç¡€ä¸Šå¢åŠ  capacityIncrement å¤§å°ï¼Œ åä¹‹ï¼ŒVector å°±åœ¨åŸå¤§å°åŸºç¡€ä¸Šå†æ‰©å……ä¸€å€ã€‚</li><li>Vectorä¸­æœ‰ä¸€ä¸ªæ–¹æ³• setSize(int newSize)ï¼Œè€ŒArrayListå¹¶æ²¡æœ‰ã€‚ setSize å…è®¸ç”¨æˆ·ä¸»åŠ¨è®¾ç½®å®¹å™¨å¤§å°ï¼Œå¦‚æœnewSizeå°äºå½“å‰ size ï¼Œ<strong>é‚£ä¹ˆelementData æ•°ç»„ä¸­åªä¼šä¿ç•™ newSize ä¸ªå…ƒç´ ï¼Œå¤šå‡ºæ¥çš„ä¼šè®¾ä¸º null</strong>ã€‚å¦‚æœnewSizeå¤§äºå½“å‰ size ï¼Œé‚£ä¹ˆå°±æ‰©å®¹åˆ° newSize å¤§å°ï¼Œæ•°ç»„ä¸­å¤šå‡ºæ¥çš„éƒ¨åˆ†è®¾ä¸º nullï¼Œä»¥åæ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¹‹å‰å¤šå‡ºæ¥çš„éƒ¨åˆ†å°±ä¼šä»¥ null çš„å½¢å¼å­˜åœ¨ã€‚</li></ol><h1 id="é›†åˆåˆ›å»º"><a href="#é›†åˆåˆ›å»º" class="headerlink" title="é›†åˆåˆ›å»º"></a>é›†åˆåˆ›å»º</h1><h2 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Shared empty array instance used for empty instances.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* åºåˆ—åŒ–æ—¶ï¼Œå¿½ç•¥è¯¥å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elementData;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Shared empty array instance used for default sized empty instances. We</span></span><br><span class="line"><span class="comment"> * distinguish this from EMPTY_ELEMENTDATA to know how much to inflate when</span></span><br><span class="line"><span class="comment"> * first element is added.</span></span><br><span class="line"><span class="comment"> * ä¸ EMPTY_ELEMENTDATA åŒºåˆ†å¼€çš„ç›®çš„æ˜¯ï¼Œæ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™å¯ä»¥ç¡®å®šæ•°ç»„çš„æŒ‡å®šé•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+ initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    elementData = c.toArray();</span><br><span class="line">    <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class="line">        <span class="keyword">if</span> (elementData.getClass() != Object[].class)</span><br><span class="line">            elementData = Arrays.copyOf(elementData, size, Object[].class);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// replace with empty array.</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ArrayList æä¾›äº†ä¸‰ç§æ–¹å¼æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå½“ä½¿ç”¨é»˜è®¤æ„é€ å™¨åˆå§‹åŒ–é›†åˆæ—¶ï¼Œæ•°æ®å­˜å‚¨åœ¨é™æ€å˜é‡ DEFAULTCAPACITY_EMPTY_ELEMENTDATA æ•°ç»„ä¸­ï¼Œ<strong>è¿™ä¸ªæ•°ç»„æ˜¯ç”± static å’Œ final ä¿®é¥°ï¼Œä½¿ç”¨é™æ€å˜é‡çš„å¥½å¤„å°±æ˜¯ JVM åŠ è½½ç±»çš„åŒæ—¶ï¼Œä¼šæŠŠé™æ€å˜é‡å­˜å‚¨äº JVM çš„æ–¹æ³•åŒºï¼ˆå„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼‰ï¼Œä¸æ¯æ¬¡ new Object[initialCapacity] ç›¸æ¯”ï¼Œå°±å‡å°‘äº†ç³»ç»Ÿçš„å¼€é”€ï¼Œè€Œä½¿ç”¨ final ä¿®é¥°æŒ‡å®šè¯¥å˜é‡ä¸èƒ½ä¿®æ”¹ï¼Œæ˜¯å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå…¬å…±å˜é‡ï¼Œä¿®æ”¹åï¼Œä¼šå½±å“åç»­æ–°åˆå§‹åŒ–çš„ ArrayList</strong>ã€‚å¦‚æœä½¿ç”¨å¯ä»¥æŒ‡å®šé›†åˆåˆå§‹åŒ–å¤§å°æ„é€ å™¨è¿›è¡Œï¼Œå¦‚æœæŒ‡å®šå¤§å°ä¸º0 ï¼Œåˆ™æŠŠ EMPTY_ELEMENTDATA èµ‹å€¼ç»™åˆ elementDataï¼Œå¦‚æœæŒ‡å®šçš„å¤§å°å¤§äº 0 ï¼Œåˆ™éœ€è¦ new Object[initialCapacity] å¹¶æŠŠæ–°åˆ›å»ºçš„æ•°ç»„èµ‹å€¼ç»™  elementData æ•°ç»„å˜é‡ã€‚DEFAULTCAPACITY_EMPTY_ELEMENTDATA å’Œ EMPTY_ELEMENTDATA ä¸»è¦æ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒæ„é€ å™¨åˆ›å»ºçš„ ArrayList å¯¹è±¡ï¼Œè¿™ä¸ªåé¢ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚ ArrayList æä¾›æ¥å—å®ç° Collection æ¥å£çš„å®ç°ç±»æ¥è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h2 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">protected</span> Object[] elementData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> elementCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> capacityIncrement;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vector</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">int</span> capacityIncrement)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span> + initialCapacity);</span><br><span class="line">    <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">    <span class="keyword">this</span>.capacityIncrement = capacityIncrement;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vector</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(initialCapacity, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vector</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vector</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    elementData = c.toArray();</span><br><span class="line">    elementCount = elementData.length;</span><br><span class="line">    <span class="comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class="line">    <span class="keyword">if</span> (elementData.getClass() != Object[].class)</span><br><span class="line">        elementData = Arrays.copyOf(elementData, elementCount, Object[].class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Vector ä¸ ArrayList ä¸åŒçš„æ˜¯æä¾›äº†ä¸€ä¸ªå¯ä»¥æŒ‡å®š capacityIncrement ï¼ˆå¢åŠ å› å­ï¼‰çš„æ„é€ å™¨ï¼Œå¢é•¿å› å­çš„ä½œç”¨ä¸»è¦æ˜¯å¯¹æ•°ç»„è¿›è¡Œæ‰©å®¹æ—¶ï¼ŒæŒ‡å®šæ•°ç»„åœ¨åŸæ¥æ•°ç»„é•¿åº¦çš„åŸºç¡€ä¸Šåœ¨æ‰©å®¹å¤šå¤§</strong>ã€‚</p><h1 id="é›†åˆå¢åŠ ã€ä¿®æ”¹å…ƒç´ "><a href="#é›†åˆå¢åŠ ã€ä¿®æ”¹å…ƒç´ " class="headerlink" title="é›†åˆå¢åŠ ã€ä¿®æ”¹å…ƒç´ "></a>é›†åˆå¢åŠ ã€ä¿®æ”¹å…ƒç´ </h1><p>ArrayList é›†åˆæ–°å¢å…ƒç´ ä¸»è¦æ˜¯è°ƒç”¨ <strong>add(E e)</strong> å’Œ <strong>add(int index, E element)</strong> æ–¹æ³•ï¼Œæ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œéƒ½éœ€è¦å¯¹æ•°ç»„æ‰©å®¹è¿›è¡Œæ£€æŸ¥ï¼Œadd(E e) åœ¨æ•°ç»„æœ«å°¾æ·»åŠ å…ƒç´ ï¼Œadd(int index, E element) æ˜¯åœ¨æ•°ç»„æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ ï¼Œæ‰€ä»¥è¯¥ä½ç½®åçš„åŸæ•°ç»„å…ƒç´ éƒ½è¦å‘åç§»åŠ¨ä¸€ä½ã€‚ä¿®æ”¹å…ƒç´ è°ƒç”¨ <strong>set(int index, E e)</strong>ï¼Œæ›¿æ¢æ‰å…ƒæ•°ç»„ï¼Œsize ä¸å˜ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡å…·ä½“æºç è¿›è¡Œå­¦ä¹ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ‰©å®¹</span></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">//æ¯æ¬¡éƒ½ä¼šæŠŠæœ€æ–°æ·»åŠ çš„å…ƒç´ æ”¾åˆ°æ•°ç»„æœ«å°¾</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥æ•°ç»„æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">//ç§»åŠ¨æŒ‡å®šä½ç½®åçš„å…ƒç´ </span></span><br><span class="line">    System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>, size - index);</span><br><span class="line">    <span class="comment">//æ’å…¥å…ƒç´ </span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ é›†åˆå…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line">    <span class="comment">// æ•°ç»„ç§»åŠ¨å¹¶æ‹·è´åˆ° elementData æ•°ç»„ä¸­</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, size, numNew);</span><br><span class="line">    size += numNew;</span><br><span class="line">    <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨æŒ‡å®šä½ç½®æ·»åŠ é›†åˆå…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">//å¯¹è‡ªèº«è¿›è¡Œç§»åŠ¨å¹¶ copy å…ƒç´ </span></span><br><span class="line">        System.arraycopy(elementData, index, elementData, index + numNew,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// copy é›†åˆä¸­çš„å…ƒç´ åˆ° elementData ä¸­</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, index, numNew);</span><br><span class="line">    size += numNew;</span><br><span class="line">    <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateCapacity</span><span class="params">(Object[] elementData, <span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// DEFAULTCAPACITY_EMPTY_ELEMENTDATA çš„ä½œç”¨</span></span><br><span class="line">    <span class="comment">//ä½¿ç”¨é»˜è®¤æ„é€ å™¨åˆ›å»ºçš„å¯¹è±¡ï¼Œç¬¬ä¸€æ¬¡æ–°å¢å…ƒç´ æ—¶ï¼ŒæŒ‡å®šæ•°ç»„é»˜è®¤é•¿åº¦ä¸º10</span></span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">//oldCapacity &gt;&gt; 1å’ŒoldCapacity / 2æ˜¯ç­‰æ•ˆçš„ï¼ŒnewCapacityä¸ºåŸæ¥çš„1.5å€</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)  <span class="comment">//æ•°ç»„ä¸æ˜¯æ— é™å¤§ï¼Œéœ€æ³¨æ„</span></span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    <span class="comment">//è¿›è¡Œæ•°ç»„æ‹·è´ï¼ŒArrays.copyOfçš„åº•å±‚æ˜¯ä¸€ä¸ªnativeæ–¹æ³•</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">        MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥æ‰¾å…ƒç´  O(1)</span></span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line">    <span class="comment">//æ›¿æ¢æ‰åŸæ•°æ®</span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheck</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A version of rangeCheck used by add and addAll.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheckForAdd</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt; size || index &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line"><span class="function">E <span class="title">elementData</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (E) elementData[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€æ‰©å®¹"><a href="#åŠ¨æ€æ‰©å®¹" class="headerlink" title="åŠ¨æ€æ‰©å®¹"></a>åŠ¨æ€æ‰©å®¹</h2><p>ArrayList å’Œ Vector çš„æ–°å¢ã€ä¿®æ”¹å…ƒç´ çš„é€»è¾‘åŸºæœ¬ä¸€è‡´ï¼Œä¸åŒçš„åœ°æ–¹å°±æ˜¯ä¼šåœ¨æ¯ä¸ªæ–¹æ³•ä¸Šä½¿ç”¨ <strong>synchronized</strong> å…³é”®å­—è¿›è¡ŒåŒæ­¥ï¼Œè¿™é‡Œé‡ç‚¹è¯´æ˜ä¸‹ä»–ä»¬åŠ¨æ€æ‰©å®¹çš„ä¸åŒä¹‹å¤„.</p><p><strong>Vector</strong> çš„åŠ¨æ€æ‰©å®¹æœºåˆ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">//æ•°ç»„æ‰©å®¹</span></span><br><span class="line">    ensureCapacityHelper(elementCount + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//æœ«å°¾æ’å…¥å…ƒç´ </span></span><br><span class="line">    elementData[elementCount++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityHelper</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">// capacityIncrement &gt; 0 åˆ™æ‰©å®¹ capacityIncrement å¤§å°ï¼Œå¦åˆ™æ‰©å®¹åŸæ¥çš„ä¸€å€</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + ((capacityIncrement &gt; <span class="number">0</span>) ?</span><br><span class="line">                                     capacityIncrement : oldCapacity);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">        MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“åˆ ArrayList çš„æ‰©å®¹ä»£ç ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºä¸ Vector çš„ä¸åŒä¹‹å¤„ï¼Œæ‰€ä»¥ä½¿ç”¨ç±»ä¹‹å‰é˜…è¯»ä»£ç æ˜¯å¾ˆå¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚</p><h1 id="åˆ é™¤é›†åˆé‡Œçš„å…ƒç´ "><a href="#åˆ é™¤é›†åˆé‡Œçš„å…ƒç´ " class="headerlink" title="åˆ é™¤é›†åˆé‡Œçš„å…ƒç´ "></a>åˆ é™¤é›†åˆé‡Œçš„å…ƒç´ </h1><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ ArrayList æ¥è¯´æ˜é›†åˆåˆ é™¤å…ƒç´ çš„é€»è¾‘ï¼Œåˆ é™¤ä¹Ÿåˆ†ä¸ºå¯¹å•ä¸ªå…ƒç´ çš„åˆ é™¤å’Œé›†åˆåˆ é™¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    modCount++;</span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">//ç›´æ¥è¿›è¡Œæ•°ç»„æ‹·è´æ“ä½œï¼ŒæŠŠindexåçš„æ‰€æœ‰å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä½ã€‚</span></span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index, numMoved);</span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¹‹æ‰€ä»¥å«åšå¿«é€Ÿåˆ é™¤ï¼Œæ˜¯å› ä¸ºä»–è¢«è®¾ç½®ä¸ºä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œåªèƒ½åœ¨å†…éƒ¨è°ƒç”¨ï¼Œåˆ é™¤å…ƒç´ çš„æ—¶å€™ï¼Œçœå»äº†æ•°ç»„è¶Šç•Œçš„åˆ¤æ–­ã€‚</span></span><br><span class="line"><span class="comment">//ä¹Ÿä¸è¿”å›è¢«åˆ é™¤çš„å…ƒç´ ï¼Œç›´æ¥è¿›è¡Œæ•°ç»„æ‹·è´æ“ä½œã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fastRemove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index, numMoved);</span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤é›†åˆä¸­æŒ‡å®šçš„å…ƒç´ ï¼ŒæŒ‡å®šä¸­çš„é›†åˆå…ƒç´ ä¸èƒ½ä¸º null</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">return</span> batchRemove(c, <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤ä¸åœ¨é›†åˆä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">retainAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">return</span> batchRemove(c, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰¹é‡å¾ªç¯åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">batchRemove</span><span class="params">(Collection&lt;?&gt; c, <span class="keyword">boolean</span> complement)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object[] elementData = <span class="keyword">this</span>.elementData;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (; r &lt; size; r++)</span><br><span class="line">            <span class="comment">// c.contains é»˜è®¤çš„æ˜¯ Collection æ¥å£çš„æ–¹æ³•ï¼Œåœ¨ AbstractCollection ä¸­é‡‡ç”¨ Iterator æœºåˆ¶æ¥åˆ¤æ–­æ˜¯å¦åŒ…å«å…ƒç´ ï¼ŒArrayList è‡ªå·±å®ç°äº†æ­¤æ–¹æ³•</span></span><br><span class="line">            <span class="comment">// complement åˆ é™¤æ–¹æ³•è°ƒç”¨ä¼ å…¥çš„æ˜¯ false</span></span><br><span class="line">            <span class="comment">// ç¬¬ä¸€ï¼Œä½œè€…å·§å¦™çš„æå–äº†é€»è¾‘ä¸Šçš„æœ€å¤§å…¬çº¦æ•°ï¼Œä»…é€šè¿‡ä¸€è¡Œé€»è¾‘åˆ¤æ–­å°±å®ç°äº†ä¸¤ä¸ªäº’æ–¥çš„æ•ˆæœã€‚</span></span><br><span class="line">            <span class="comment">// ç¬¬äºŒï¼Œä½œè€…çš„æ‰€ç”¨æ“ä½œéƒ½é›†ä¸­äº elementData ä¸€ä¸ªæ•°ç»„ä¸Šï¼Œé¿å…äº†èµ„æºçš„æµªè´¹ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (c.contains(elementData[r]) == complement)</span><br><span class="line">                elementData[w++] = elementData[r];</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// Preserve behavioral compatibility with AbstractCollection, even if c.contains() throws.</span></span><br><span class="line">        <span class="comment">// ç†è®ºä¸Šr==size åªæœ‰å½“å‡ºç°å¼‚å¸¸æƒ…å†µçš„æ—¶å€™ï¼Œæ‰ä¼šå‡ºç°r!=sizeï¼Œä¸€æ—¦å‡ºç°äº†å¼‚å¸¸ï¼Œé‚£ä¹ˆåŠ¡å¿…è¦å°†ä¹‹å‰è¢«ä¿®æ”¹è¿‡çš„æ•°ç»„å†è¿˜åŸå›æ¥ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (r != size) &#123;</span><br><span class="line">            System.arraycopy(elementData, r, elementData, w, size - r);</span><br><span class="line">            w += size - r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ é™¤ w ä½ç½®åçš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">if</span> (w != size) &#123;</span><br><span class="line">            <span class="comment">// clear to let GC do its work</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = w; i &lt; size; i++)</span><br><span class="line">                elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">            modCount += size - w;</span><br><span class="line">            size = w;</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é›†åˆå…ƒç´ çš„è¿­ä»£ï¼ˆé¡ºåºè¿­ä»£ï¼‰"><a href="#é›†åˆå…ƒç´ çš„è¿­ä»£ï¼ˆé¡ºåºè¿­ä»£ï¼‰" class="headerlink" title="é›†åˆå…ƒç´ çš„è¿­ä»£ï¼ˆé¡ºåºè¿­ä»£ï¼‰"></a>é›†åˆå…ƒç´ çš„è¿­ä»£ï¼ˆé¡ºåºè¿­ä»£ï¼‰</h1><p>ArrayList è¿­ä»£å™¨æ˜¯é€šè¿‡å®ç° Iterator æ¥å£ å’Œ ListIterator æ¥å£å®ç°é›†åˆçš„é¡ºåºè¿­ä»£ï¼ŒIterator æ¥å£ä¸»è¦æ˜¯å‘åéå†é›†åˆå…ƒç´ ï¼Œéå†çš„åŒæ—¶å¯ä»¥å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œåˆ é™¤ã€‚ListIterator æ˜¯ List æ¥å£æä¾›çš„æ–¹æ³•è¿”å›ç±»å‹ï¼Œé›†åˆç±»è‡ªè¡Œå®ç° ListIterator æ¥å£æ¥å®ç°åŒå‘è¿­ä»£åŠŸèƒ½ï¼Œ åŒæ—¶ ListIterator æ¥å£åœ¨ Iterator æ¥å£çš„åŠŸèƒ½ä¸Šæä¾›äº†å‘å‰éå†ï¼ŒæŒ‡å®šä½ç½®å‰åéå†ï¼Œä¿®æ”¹é›†åˆå…ƒç´ ï¼Œæ·»åŠ é›†åˆå…ƒç´ çš„åŠŸèƒ½ã€‚æˆ‘ä»¬é€šè¿‡æºç å…·ä½“åˆ†æ ArrayList è¿­ä»£å™¨çš„å®ç°ã€‚</p><h2 id="Iterator-æ¥å£"><a href="#Iterator-æ¥å£" class="headerlink" title="Iterator æ¥å£"></a>Iterator æ¥å£</h2><p>Iterator æ¥å£è§„èŒƒäº† Java é›†åˆè¿­ä»£çš„æ–¹å¼ï¼Œé€šè¿‡ä½¿ç”¨è¿­ä»£å™¨ï¼Œæ–¹ä¾¿çš„è¿­ä»£é›†åˆä¸­çš„å…ƒç´ ã€‚åŒæ—¶ä¹Ÿæ˜¯è®¾è®¡æ¨¡å¼é‡Œçš„è¿­ä»£å™¨æ¨¡å¼åœ¨ JDK é‡Œçš„å…·ä½“å®ç°ã€‚Javaé›†åˆä¸­å®ç° Collection æ¥å£çš„éƒ½å®ç°äº† Iterable  æ¥å£ã€‚</p><h2 id="Iterable-æ¥å£"><a href="#Iterable-æ¥å£" class="headerlink" title="Iterable æ¥å£"></a>Iterable æ¥å£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterable</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Iterator&lt;T&gt; <span class="title">iterator</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add JDK1.8</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">forEach</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; action)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(action);</span><br><span class="line">        <span class="keyword">for</span> (T t : <span class="keyword">this</span>) &#123;</span><br><span class="line">            action.accept(t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add JDK1.8</span></span><br><span class="line">    <span class="comment">// JDK 1.8 æä¾›çš„åˆ†å‰²è¿­ä»£</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> Spliterator&lt;T&gt; <span class="title">spliterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Spliterators.spliteratorUnknownSize(iterator(), <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‹ä¸€ä¸ªå…ƒç´ å¯¹è±¡</span></span><br><span class="line">        <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="function">E <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// JDK 1.8 æ”¯æŒæ¥å£é‡Œçš„æ–¹æ³•å¯ä»¥æœ‰å®ç°</span></span><br><span class="line">        <span class="comment">//åˆ é™¤ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"remove"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// JDK 1.8 æ–°å¢</span></span><br><span class="line">        <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">forEachRemaining</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; action)</span> </span>&#123;</span><br><span class="line">            Objects.requireNonNull(action);</span><br><span class="line">            <span class="keyword">while</span> (hasNext())</span><br><span class="line">                action.accept(next());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure><h2 id="ArrayList-çš„-iterator-ä»£ç å®ç°åˆ†æ"><a href="#ArrayList-çš„-iterator-ä»£ç å®ç°åˆ†æ" class="headerlink" title="ArrayList çš„ iterator ä»£ç å®ç°åˆ†æ"></a>ArrayList çš„ iterator ä»£ç å®ç°åˆ†æ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Iterable æ¥å£çš„æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//An optimized version of AbstractList.Itr</span></span><br><span class="line"><span class="comment">//å¤§å®¶å¯ä»¥çœ‹ä¸‹ AbstractList çš„ Itr å®ç°</span></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// æ¸¸æ ‡</span></span><br><span class="line">    <span class="keyword">int</span> cursor;       <span class="comment">// index of next element to return</span></span><br><span class="line">    <span class="keyword">int</span> lastRet = -<span class="number">1</span>; <span class="comment">// index of last element returned; -1 if no such</span></span><br><span class="line">    <span class="comment">//é›†åˆä¿®æ”¹æ ‡å¿—</span></span><br><span class="line">    <span class="comment">//å…³äºå¿«é€Ÿå¤±è´¥æœºåˆ¶çš„å®ç°ï¼Œç¨åä¼šæœ‰è®²è§£</span></span><br><span class="line">    <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">    Itr() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cursor != size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥é›†åˆæ˜¯å¦è¢«ä¿®æ”¹</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= size)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">        Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        cursor = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨æ­¤æ–¹æ³•å‰ï¼Œå¿…é¡»è°ƒç”¨ next() æ–¹æ³•, å¦‚æœä¸è°ƒ next() æ–¹æ³•, é‚£ä¹ˆ lastRet == -1,ç¨‹åºä¼šæŠ¥é”™æŠ›å¼‚å¸¸</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">        checkForComodification();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ArrayList.<span class="keyword">this</span>.remove(lastRet);</span><br><span class="line">            cursor = lastRet;</span><br><span class="line">            lastRet = -<span class="number">1</span>;</span><br><span class="line">            expectedModCount = modCount;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">forEachRemaining</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; consumer)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(consumer);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> size = ArrayList.<span class="keyword">this</span>.size;</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= size) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= elementData.length) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (i != size &amp;&amp; modCount == expectedModCount) &#123;</span><br><span class="line">            consumer.accept((E) elementData[i++]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// update once at end of iteration to reduce heap write traffic</span></span><br><span class="line">        cursor = i;</span><br><span class="line">        lastRet = i - <span class="number">1</span>;</span><br><span class="line">        checkForComodification();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (modCount != expectedModCount)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// List æ¥å£çš„æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListItr(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æŒ‡å®šä½ç½®å¤„éå†</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"Index: "</span>+index);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿ Itr ç±»ï¼ŒåŒæ—¶æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰ç‰¹æ€§</span></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListItr</span> <span class="keyword">extends</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">ListIterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//æŒ‡å®šä½ç½®è¿›è¡Œéå†</span></span><br><span class="line">    ListItr(<span class="keyword">int</span> index) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        cursor = index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘å‰éå†é›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cursor != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cursor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cursor - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="comment">// å‘å‰éå†ï¼Œæ¸¸æ ‡ - 1</span></span><br><span class="line">        <span class="keyword">int</span> i = cursor - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">        Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        cursor = i;</span><br><span class="line">        <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹é›†åˆå…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">        checkForComodification();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ArrayList.<span class="keyword">this</span>.set(lastRet, e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–°å¢é›†åˆå…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> i = cursor;</span><br><span class="line">            ArrayList.<span class="keyword">this</span>.add(i, e);</span><br><span class="line">            cursor = i + <span class="number">1</span>;</span><br><span class="line">            lastRet = -<span class="number">1</span>;</span><br><span class="line">            expectedModCount = modCount;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸ºä»€ä¹ˆè¦æœ‰è¿­ä»£å™¨"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰è¿­ä»£å™¨" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰è¿­ä»£å™¨"></a>ä¸ºä»€ä¹ˆè¦æœ‰è¿­ä»£å™¨</h2><p>æˆ‘ä»¬å·²ç»æ¸…æ¥šäº† ArrayList é›†åˆçš„å…·ä½“è¿­ä»£å®ç°ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰æƒ³è¿‡ Java ä¸ºä»€ä¹ˆè¦å®ç°è¿­ä»£å™¨çš„æ–¹å¼æ¥éå†é›†åˆå‘¢ï¼Œå…¶ä¸­çš„å¥¥ç§˜å’Œè®¾è®¡ç†å¿µæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æ¦‚å†µä¸ºï¼š</p><blockquote><p>Iterator æ¥å£æä¾›äº†éå†é›†åˆç±»çš„è§„èŒƒã€‚å®ƒæŠŠè®¿é—®é€»è¾‘ä»ä¸åŒç±»å‹çš„é›†åˆç±»ä¸­æŠ½è±¡å‡ºæ¥ï¼Œä»è€Œé¿å…å‘å®¢æˆ·ç«¯æš´éœ²é›†åˆçš„å†…éƒ¨ç»“æ„ï¼ˆæ•°ç»„ã€é“¾è¡¨ç­‰ç»“æ„ï¼‰ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ Iteratorï¼Œéå†ä¸€ä¸ªæ•°ç»„çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç´¢å¼•ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;array.size(); i++) &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> get(i) ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œè®¿é—®ä¸€ä¸ªé“¾è¡¨ï¼ˆLinkedListï¼‰åˆå¿…é¡»ä½¿ç”¨ while å¾ªç¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ((e=e.next())!=<span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> e.data() ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä¸¤ç§æ–¹æ³•å®¢æˆ·ç«¯éƒ½å¿…é¡»äº‹å…ˆçŸ¥é“é›†åˆçš„å†…éƒ¨ç»“æ„ï¼Œè®¿é—®ä»£ç å’Œé›†åˆæœ¬èº«æ˜¯ç´§è€¦åˆï¼Œæ— æ³•å°†è®¿é—®é€»è¾‘ä»é›†åˆç±»å’Œå®¢æˆ·ç«¯ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œæ¯ä¸€ç§é›†åˆå¯¹åº”ä¸€ç§éå†æ–¹æ³•ï¼Œå®¢æˆ·ç«¯ä»£ç æ— æ³•å¤ç”¨ã€‚æ›´ææ€–çš„æ˜¯ï¼Œå¦‚æœä»¥åéœ€è¦æŠŠ ArrayList æ›´æ¢ä¸º LinkedList ï¼Œåˆ™åŸæ¥çš„å®¢æˆ·ç«¯ä»£ç å¿…é¡»å…¨éƒ¨é‡å†™ã€‚</p><p>ä¸ºè§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒIteratoræ¨¡å¼æ€»æ˜¯ç”¨åŒä¸€ç§é€»è¾‘æ¥éå†é›†åˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Iterator it = c.iterater(); it.hasNext(); ) &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¥¥ç§˜åœ¨äºå®¢æˆ·ç«¯è‡ªèº«ä¸ç»´æŠ¤éå†é›†åˆçš„â€æŒ‡é’ˆâ€ï¼Œæ‰€æœ‰çš„å†…éƒ¨çŠ¶æ€ï¼ˆå¦‚å½“å‰å…ƒç´ ä½ç½®ï¼Œæ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼‰éƒ½ç”± Iterator æ¥ç»´æŠ¤ï¼Œè€Œè¿™ä¸ª Iterator ç”±é›†åˆç±»é€šè¿‡å·¥å‚æ–¹æ³•ç”Ÿæˆï¼Œå› æ­¤ï¼Œå®ƒçŸ¥é“å¦‚ä½•éå†æ•´ä¸ªé›†åˆã€‚å®¢æˆ·ç«¯ä»ä¸ç›´æ¥å’Œé›†åˆç±»æ‰“äº¤é“ï¼Œå®ƒæ€»æ˜¯æ§åˆ¶ Iterator ï¼Œå‘å®ƒå‘é€â€å‘å‰â€ï¼Œâ€å‘åâ€ï¼Œâ€å–å½“å‰å…ƒç´ â€çš„å‘½ä»¤ï¼Œå°±å¯ä»¥é—´æ¥éå†æ•´ä¸ªé›†åˆã€‚</p></blockquote><h2 id="fail-fast-æœºåˆ¶"><a href="#fail-fast-æœºåˆ¶" class="headerlink" title="fail-fast æœºåˆ¶"></a>fail-fast æœºåˆ¶</h2><p>é€šè¿‡é˜…è¯» ArrayList è¿­ä»£å™¨æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é›†åˆåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ–°å¢ã€ä¿®æ”¹æˆ–è€…åˆ é™¤é›†åˆå…ƒç´ æ—¶ï¼Œç¨‹åºæœ‰å¯èƒ½ä¼šæŠ›å‡ºConcurrentModificationException å¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸çš„è®¾ç½®ï¼Œå°±æ˜¯é›†åˆè¿­ä»£ fail-fast æœºåˆ¶ã€‚å¤§å®¶å¯ä»¥åœ¨æ–‡ç« ä¸­æœç´¢ ConcurrentModificationException å‡ºç°çš„åœ°æ–¹ï¼Œç»“åˆé˜…è¯»æºç æ¥äº†è§£ fail-fast æœºåˆ¶å®ç°é€»è¾‘ã€‚<br>fail-fast æœºåˆ¶å…·ä½“å¯ä»¥æ¦‚å†µä¸ºï¼š</p><blockquote><p>fail-fast æœºåˆ¶æ˜¯javaé›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</p></blockquote><h3 id="fail-fast-ç›®çš„"><a href="#fail-fast-ç›®çš„" class="headerlink" title="fail-fast ç›®çš„"></a>fail-fast ç›®çš„</h3><blockquote><p>è¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºæ— æ³•å¾—åˆ°ä¿è¯ï¼Œå› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œä¸å¯èƒ½å¯¹æ˜¯å¦å‡ºç°ä¸åŒæ­¥å¹¶å‘ä¿®æ”¹åšå‡ºä»»ä½•ç¡¬æ€§ä¿è¯ã€‚å¿«é€Ÿå¤±è´¥è¿­ä»£å™¨ä¼šå°½æœ€å¤§åŠªåŠ›æŠ›å‡º ConcurrentModificationExceptionã€‚å› æ­¤ï¼Œä¸ºæé«˜è¿™ç±»è¿­ä»£å™¨çš„æ­£ç¡®æ€§è€Œç¼–å†™ä¸€ä¸ªä¾èµ–äºæ­¤å¼‚å¸¸çš„ç¨‹åºæ˜¯é”™è¯¯çš„åšæ³•ï¼šè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºåº”è¯¥ä»…ç”¨äºæ£€æµ‹ bugã€‚</p></blockquote><h3 id="fail-fast-åŸå› "><a href="#fail-fast-åŸå› " class="headerlink" title="fail-fast åŸå› "></a>fail-fast åŸå› </h3><p>ArrayList é›†åˆç»´æŠ¤äº†ä¸€ä¸ªå…¨å±€å˜é‡ modCount ï¼Œ åˆå§‹å€¼ä¸º 0ï¼Œ å®ƒæ˜¯é›†åˆ AbstractList æŠ½è±¡ç±»é‡Œçš„ã€‚å½“æˆ‘ä»¬è°ƒç”¨ ArrayList çš„ add ã€ remove ã€ clear æ–¹æ³•ï¼Œ modCount å˜é‡å€¼ä¼šå¢åŠ ï¼Œå¯ä»¥å‘ç° modCount å€¼æ˜¯ç”¨æ¥è®°å½•é›†åˆå‘ç”Ÿä¿®æ”¹çš„æ¬¡æ•°ã€‚é˜…è¯» ArrayList è¿­ä»£å™¨å®ç°ä»£ç ï¼Œæˆ‘ä»¬å‘ç°ç¨‹åºä¸­æœ‰ int expectedModCount = modCount çš„é€»è¾‘ï¼Œå½“æˆ‘ä»¬è¦è¿­ä»£é›†åˆæ—¶ï¼Œåˆ›å»ºçš„è¿­ä»£å™¨çš„ expectedModCount ä¸ modCount å€¼ç›¸åŒï¼Œè€Œå½“ ArrayList å‘ç”Ÿä¿®æ”¹æ—¶ï¼ŒmodCount å€¼å‘ç”Ÿå˜åŒ–ï¼Œè€Œè¿­ä»£å™¨å¹¶æ²¡æœ‰åŒæ­¥åˆ°modCount å€¼çš„å˜åŒ–ï¼Œå½“ç¨‹åºè°ƒç”¨è¿­ä»£å™¨ next æ–¹æ³•ï¼Œä¼šè§¦å‘ç¨‹åºè®¾ç½®çš„ checkForComodification æ–¹æ³•ï¼Œè€Œæ­¤æ—¶ expectedModCount != modCount ,åˆ™æŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚å½“ç„¶ï¼Œè¿­ä»£çš„ç¨‹åºæ£€æŸ¥åˆ°æ•°ç»„è¶Šç•Œå¼‚å¸¸ï¼Œæˆ–è€…å½“ cursor çš„å€¼å¤§äº ArrayList çš„ elementData.length çš„å€¼ï¼Œä¹Ÿä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚</p><h3 id="fail-fast-æœºåˆ¶å…·ä½“æ¡ˆä¾‹"><a href="#fail-fast-æœºåˆ¶å…·ä½“æ¡ˆä¾‹" class="headerlink" title="fail-fast æœºåˆ¶å…·ä½“æ¡ˆä¾‹"></a>fail-fast æœºåˆ¶å…·ä½“æ¡ˆä¾‹</h3><p>å•çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è°ƒç”¨ ArrayList çš„ remove æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">singleThreadArrayList</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; integerList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">    integerList.add(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    Iterator&lt;Integer&gt; iterator = integerList.iterator();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line"></span><br><span class="line">        Integer integer = iterator.next();</span><br><span class="line">        <span class="keyword">if</span>(integer == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨ ArrayList çš„ remove æ–¹æ³•åï¼ŒexpectedModCount != modCountï¼ŒæŠ›å¼‚å¸¸</span></span><br><span class="line">            <span class="comment">// è°ƒç”¨ Iterator çš„ remove æ–¹æ³•ï¼Œåˆ™ç¨‹åºæ‰§è¡Œæ­£å¸¸</span></span><br><span class="line">            integerList.remove(integer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¿è¡ŒåæŠ›å‡ºå¼‚å¸¸ï¼š<br><img src="/images/post/2016/02/single_thread_iterator.jpg" alt="single_thread_iterator"></p><p>å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œè°ƒç”¨ Iterator çš„ remove æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;Integer&gt; integerList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">multiThreadArrayList</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">10</span>;i++)&#123;</span><br><span class="line">        integerList.add(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Thread oneThread = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        Iterator&lt;Integer&gt; iterator = integerList.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> value = iterator.next();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"thread one iterator value:"</span> + value);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1L</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    Thread twoThread = <span class="keyword">new</span> Thread(() -&gt;&#123;</span><br><span class="line"></span><br><span class="line">        Iterator&lt;Integer&gt; iterator = integerList.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> value = iterator.next();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"thread two iterator value:"</span> + value);</span><br><span class="line">            <span class="keyword">if</span>( value == <span class="number">8</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">"thread two remove value:"</span> + value);</span><br><span class="line">                iterator.remove();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    oneThread.start();</span><br><span class="line">    twoThread.start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//ç­‰å¾…çº¿ç¨‹ one æ‰§è¡Œå®Œæˆ</span></span><br><span class="line">        oneThread.join();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¿è¡ŒåæŠ›å‡ºå¼‚å¸¸ï¼š<br><img src="/images/post/2016/02/mulit_thread_iterator.jpg" alt="mulit_thread_iterator"></p><p>å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ä¿®æ”¹é›†åˆå…ƒç´ ä¸€å®šè¦è°¨æ…ï¼Œä»¥å…ç¨‹åºå¼‚å¸¸ã€‚</p><h1 id="å­é›†æ“ä½œåŠæ³¨æ„äº‹é¡¹"><a href="#å­é›†æ“ä½œåŠæ³¨æ„äº‹é¡¹" class="headerlink" title="å­é›†æ“ä½œåŠæ³¨æ„äº‹é¡¹"></a>å­é›†æ“ä½œåŠæ³¨æ„äº‹é¡¹</h1><p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½åªæƒ³å–å¾— List é›†åˆä¸­çš„æŸæ®µè¿ç»­çš„é›†åˆå…ƒç´ ï¼ŒArrayList å’Œ Vector éƒ½æä¾›äº† subList æ–¹æ³•æ¥æˆªå–é›†åˆçš„ä¸€éƒ¨åˆ†æ¥æ–¹ä¾¿æˆ‘ä»¬çš„ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªåŠŸèƒ½å¸¦æ¥æ–¹ä¾¿çš„åŒæ—¶ï¼Œä¹Ÿéœ€è¦æ³¨æ„ï¼š</p><blockquote><p>subList è¿”å›ä»…ä»…åªæ˜¯é›†åˆå¯¹è±¡ä¸€ä¸ªè§†å›¾ï¼Œæ“ä½œ subList ååŸé›†åˆå¯¹è±¡ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚</p></blockquote><p>SubList ç±»æ˜¯ ArrayList ç±»é‡Œçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒsubList ä¹Ÿæä¾›äº†æ“ä½œé›†åˆçš„ æ–°å¢ add ï¼Œä¿®æ”¹ set, åˆ é™¤ remove, è·å– get ç­‰æ–¹æ³•ï¼Œè¿˜å®ç°äº†å­é›†åˆè¿­ä»£çš„åŠŸèƒ½ã€‚æˆ‘ä»¬é€šè¿‡æºç çœ‹çœ‹å…¶å†…éƒ¨å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä»å½“å‰ List ä¸­åˆ›å»ºä¸€ä¸ªæŒ‡å®šèµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„ subList</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;E&gt; <span class="title">subList</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¾¹ç•Œæ£€æŸ¥</span></span><br><span class="line">    subListRangeCheck(fromIndex, toIndex, size);</span><br><span class="line">    <span class="comment">// this æŒ‡ä»£å½“å‰å¯¹è±¡ï¼Œå¹¶ä¼ åˆ° SubList ä¸­</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SubList(<span class="keyword">this</span>, <span class="number">0</span>, fromIndex, toIndex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">subListRangeCheck</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex, <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fromIndex &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"fromIndex = "</span> + fromIndex);</span><br><span class="line">    <span class="keyword">if</span> (toIndex &gt; size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"toIndex = "</span> + toIndex);</span><br><span class="line">    <span class="keyword">if</span> (fromIndex &gt; toIndex)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"fromIndex("</span> + fromIndex +</span><br><span class="line">                                           <span class="string">") &gt; toIndex("</span> + toIndex + <span class="string">")"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SubList</span> <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">RandomAccess</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractList&lt;E&gt; parent;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> parentOffset;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> offset;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    SubList(AbstractList&lt;E&gt; parent,</span><br><span class="line">            <span class="keyword">int</span> offset, <span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex) &#123;</span><br><span class="line">        <span class="keyword">this</span>.parent = parent;</span><br><span class="line">        <span class="keyword">this</span>.parentOffset = fromIndex;</span><br><span class="line">        <span class="keyword">this</span>.offset = offset + fromIndex;</span><br><span class="line">        <span class="keyword">this</span>.size = toIndex - fromIndex;</span><br><span class="line">        <span class="keyword">this</span>.modCount = ArrayList.<span class="keyword">this</span>.modCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹å­é›†åˆä¸­çš„å…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E e)</span> </span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="comment">// è·å–åˆ° this å¯¹è±¡çš„ ArrayList ä¸­çš„å…ƒç´ </span></span><br><span class="line">        E oldValue = ArrayList.<span class="keyword">this</span>.elementData(offset + index);</span><br><span class="line">        <span class="comment">// åŒæ—¶ this æŒ‡ä»£çš„ ArrayList é›†åˆä¸­çš„å…ƒç´ ä¹Ÿè¢«ä¿®æ”¹</span></span><br><span class="line">        ArrayList.<span class="keyword">this</span>.elementData[offset + index] = e;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å­é›†åˆä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ˜¯å¦ä¿®æ”¹ï¼Œfail-fast æœºåˆ¶</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">return</span> ArrayList.<span class="keyword">this</span>.elementData(offset + index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­é›†åˆé•¿åº¦çš„å¤§å°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨æŒ‡å®šä½ç½®ä¿®æ”¹é›†åˆå…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E e)</span> </span>&#123;</span><br><span class="line">        rangeCheckForAdd(index);</span><br><span class="line">        checkForComodification();</span><br><span class="line">        parent.add(parentOffset + index, e);</span><br><span class="line">        <span class="keyword">this</span>.modCount = parent.modCount;</span><br><span class="line">        <span class="keyword">this</span>.size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line">        checkForComodification();</span><br><span class="line">        E result = parent.remove(parentOffset + index);</span><br><span class="line">        <span class="keyword">this</span>.modCount = parent.modCount;</span><br><span class="line">        <span class="keyword">this</span>.size--;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‰ç…§èŒƒå›´åˆ é™¤å…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        parent.removeRange(parentOffset + fromIndex,</span><br><span class="line">                           parentOffset + toIndex);</span><br><span class="line">        <span class="keyword">this</span>.modCount = parent.modCount;</span><br><span class="line">        <span class="keyword">this</span>.size -= toIndex - fromIndex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢åŠ é›†åˆå…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> addAll(<span class="keyword">this</span>.size, c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡å®šä½ç½®å‡ºå¢åŠ é›†åˆå…ƒç´ </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        rangeCheckForAdd(index);</span><br><span class="line">        <span class="keyword">int</span> cSize = c.size();</span><br><span class="line">        <span class="keyword">if</span> (cSize==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        checkForComodification();</span><br><span class="line">        parent.addAll(parentOffset + index, c);</span><br><span class="line">        <span class="keyword">this</span>.modCount = parent.modCount;</span><br><span class="line">        <span class="keyword">this</span>.size += cSize;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿­ä»£å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> listIterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        rangeCheckForAdd(index);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> offset = <span class="keyword">this</span>.offset;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListIterator&lt;E&gt;() &#123;</span><br><span class="line">            <span class="keyword">int</span> cursor = index;</span><br><span class="line">            <span class="keyword">int</span> lastRet = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> expectedModCount = ArrayList.<span class="keyword">this</span>.modCount;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cursor != SubList.<span class="keyword">this</span>.size;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">            <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line">                <span class="keyword">int</span> i = cursor;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= SubList.<span class="keyword">this</span>.size)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">                Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">                <span class="keyword">if</span> (offset + i &gt;= elementData.length)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                cursor = i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> (E) elementData[offset + (lastRet = i)];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cursor != <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">            <span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line">                <span class="keyword">int</span> i = cursor - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">                Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">                <span class="keyword">if</span> (offset + i &gt;= elementData.length)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                cursor = i;</span><br><span class="line">                <span class="keyword">return</span> (E) elementData[offset + (lastRet = i)];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">forEachRemaining</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; consumer)</span> </span>&#123;</span><br><span class="line">                Objects.requireNonNull(consumer);</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> size = SubList.<span class="keyword">this</span>.size;</span><br><span class="line">                <span class="keyword">int</span> i = cursor;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= size) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">final</span> Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">                <span class="keyword">if</span> (offset + i &gt;= elementData.length) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (i != size &amp;&amp; modCount == expectedModCount) &#123;</span><br><span class="line">                    consumer.accept((E) elementData[offset + (i++)]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// update once at end of iteration to reduce heap write traffic</span></span><br><span class="line">                lastRet = cursor = i;</span><br><span class="line">                checkForComodification();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cursor;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> cursor - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">                checkForComodification();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    SubList.<span class="keyword">this</span>.remove(lastRet);</span><br><span class="line">                    cursor = lastRet;</span><br><span class="line">                    lastRet = -<span class="number">1</span>;</span><br><span class="line">                    expectedModCount = ArrayList.<span class="keyword">this</span>.modCount;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">                checkForComodification();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ArrayList.<span class="keyword">this</span>.set(offset + lastRet, e);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> i = cursor;</span><br><span class="line">                    SubList.<span class="keyword">this</span>.add(i, e);</span><br><span class="line">                    cursor = i + <span class="number">1</span>;</span><br><span class="line">                    lastRet = -<span class="number">1</span>;</span><br><span class="line">                    expectedModCount = ArrayList.<span class="keyword">this</span>.modCount;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (expectedModCount != ArrayList.<span class="keyword">this</span>.modCount)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;E&gt; <span class="title">subList</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">        subListRangeCheck(fromIndex, toIndex, size);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SubList(<span class="keyword">this</span>, offset, fromIndex, toIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>ArrayList å’Œ Vector æ˜¯ä¸€ä¸ªå¯æ‰©å±•ï¼Œæœ‰åº ï¼Œå¯ä»¥è¿­ä»£çš„é›†åˆç±»å®ç°</li><li>åˆ›å»ºé›†åˆçš„æ—¶å€™ï¼Œå¦‚æœé¢„å…ˆçŸ¥é“é›†åˆçš„å¤§å°ï¼Œå¯ä»¥åˆ›å»ºå…·ä½“å¤§å°çš„é›†åˆï¼Œè¿™æ ·å¯ä»¥é¿å…é›†åˆä¸æ–­æ‰©å±•è€Œé€ æˆçš„æ€§èƒ½å½±å“</li><li>fail-fast æœºåˆ¶æ˜¯ä¸ºäº†é¢„é˜²å¹¶å‘ä¿®æ”¹é›†åˆå…ƒç´ ï¼Œè€Œé€ æˆçš„è¿­ä»£é›†åˆå…ƒç´ ä¸ä¸€è‡´çš„é—®é¢˜ã€‚è‡ªè¡Œç¼–ç¨‹ä¸èƒ½ä¾èµ–äºè¿™ç§æœºåˆ¶ï¼Œåªèƒ½ç”¨äºæ£€æµ‹ bug</li><li>subList è¿”å›ä»…ä»…åªæ˜¯é›†åˆå¯¹è±¡ä¸€ä¸ªè§†å›¾ï¼Œæ“ä½œ subList ååŸé›†åˆå¯¹è±¡ä¹Ÿä¼šè¢«ä¿®æ”¹</li></ul><h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><blockquote><p><a href="https://stackoverflow.com/questions/322715/when-to-use-linkedlist-over-arraylist" target="_blank" rel="noopener">When to use LinkedList over ArrayList?</a><br><a href="http://cmsblogs.com/?p=1220" target="_blank" rel="noopener">Javaæé«˜ç¯‡ï¼ˆä¸‰å››ï¼‰â€”â€“fail-fastæœºåˆ¶</a><br><a href="http://www.hollischuang.com/archives/33" target="_blank" rel="noopener">Javaä¸­çš„fail-fastæœºåˆ¶</a><br><a href="http://cmsblogs.com/?p=1239" target="_blank" rel="noopener">subListçš„ç¼ºé™·</a><br><a href="https://stackoverflow.com/questions/379551/java-split-a-list-into-two-sub-lists" target="_blank" rel="noopener">Java: split a List into two sub-Lists?</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€šè¿‡é˜…è¯» ArrayList ä¸ Verctor çš„æºç æˆ‘ä»¬å‘ç°ï¼Œå®ƒä»¬çš„ä»£ç å®ç°è¿‘ä¼¼åº¦å‡ ä¹åœ¨90%ã€‚æ‰€ä»¥æˆ‘æŠŠå®ƒä»¬ä¸¤ä¸ªåˆå¹¶èµ·æ¥è¿›è¡Œè¯´æ˜ï¼Œç»†å¿ƒçš„è¯»è€…å¯ä»¥è‡ªè¡Œå»IDEä¸­é˜…è¯»ï¼Œæ¯”å¯¹ä»–ä»¬çš„å®ç°ç»“æ„ã€‚æœ¬æ–‡ä¸»è¦ç»“åˆ JDK8 æºç ä»‹ç»äº† ArrayList å’Œ Vector çš„åˆ›å»ºã€å¢ã€åˆ ã€æ”¹ä»¥åŠé›†åˆçš„è¿­ä»£å’Œ fail-fast æœºåˆ¶ï¼Œå¹¶è¯´æ˜äº†åœ¨æ“ä½œå­é›†çš„ä¸€äº›æ³¨æ„äº‹é¡¹åŠåŸå› ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ— ç‰¹åˆ«è¯´æ˜ï¼ŒJDK æºç è®²è§£éƒ½æ˜¯åŸºäº JDK8 è¿›è¡Œçš„åˆ†æã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://blog.51itzone.cn/categories/Technology/"/>
    
      <category term="Java" scheme="https://blog.51itzone.cn/categories/Technology/Java/"/>
    
    
      <category term="Java" scheme="https://blog.51itzone.cn/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu ä¸‹å®‰è£… Oracle JDK çš„ä¸¤ç§æ–¹æ³•</title>
    <link href="https://blog.51itzone.cn/2016/02/13/ubuntu-install-java-two-method/"/>
    <id>https://blog.51itzone.cn/2016/02/13/ubuntu-install-java-two-method/</id>
    <published>2016-02-13T12:50:25.000Z</published>
    <updated>2018-08-20T02:11:16.649Z</updated>
    
    <content type="html"><![CDATA[<p>æ€»ç»“ ubuntu ç³»ç»Ÿä¸‹å®‰è£… Oracle JDK çš„æ–¹æ³•ï¼Œæ–¹ä¾¿å¤§å®¶ï¼Œä»¥åŠå¤‡ä»¥åä½¿ç”¨ã€‚<br><a id="more"></a></p><h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><ol><li>æ·»åŠ <a href="http://baike.baidu.com/item/Ubuntu%20PPA" target="_blank" rel="noopener">ppa(æº)</a>ï¼Œå¹¶ä¸‹è½½å®‰è£… jdk</li><li>é€šè¿‡<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">oracleå®˜ç½‘</a>ä¸‹è½½å‹ç¼©åŒ…å®‰è£…</li></ol><h1 id="ä¸€ã€é€šè¿‡-ppa-å®‰è£…-jdk"><a href="#ä¸€ã€é€šè¿‡-ppa-å®‰è£…-jdk" class="headerlink" title="ä¸€ã€é€šè¿‡ ppa å®‰è£… jdk"></a>ä¸€ã€é€šè¿‡ ppa å®‰è£… jdk</h1><h2 id="1-æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š"><a href="#1-æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š" class="headerlink" title="1. æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š"></a>1. æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install software-properties-common</span><br><span class="line">sudo add-apt-repository ppa:webupd8team/java</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h2 id="2-æ‰§è¡Œå®‰è£…-jdk-çš„å‘½ä»¤ï¼š"><a href="#2-æ‰§è¡Œå®‰è£…-jdk-çš„å‘½ä»¤ï¼š" class="headerlink" title="2. æ‰§è¡Œå®‰è£… jdk çš„å‘½ä»¤ï¼š"></a>2. æ‰§è¡Œå®‰è£… jdk çš„å‘½ä»¤ï¼š</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install oracle-java8-installer</span><br></pre></td></tr></table></figure><p>å®‰è£…è¿‡ç¨‹ï¼Œå®‰è£…å™¨ä¼šæç¤ºä½ åŒæ„ oracle çš„æœåŠ¡æ¡æ¬¾,é€‰æ‹© ok ç„¶åé€‰æ‹© yes å³å¯ã€‚<br>å½“ç„¶ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ï¼Œé»˜è®¤æ‰§è¡ŒåŒæ„é€‰æ‹©</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo oracle-java8-installer shared/accepted-oracle-license-v1-1selecttrue | sudo /usr/bin/debconf-set-selections</span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨è¿‡ç¨‹ä¸­ï¼Œç½‘é€Ÿè¾ƒæ…¢æˆ–è€…å®‰è£…ä¸­æ–­ï¼Œæˆ‘ä»¬å¯ä»¥å»å®˜ç½‘ä¸‹è½½ jdk çš„å‹ç¼©åŒ…ï¼Œæ”¾åˆ°<code>/var/cache/oracle-jdk8-installer</code>ç›®å½•ä¸‹ï¼Œç„¶ååœ¨æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼Œå®‰è£…å™¨åˆ™ä¼šé»˜è®¤ä½¿ç”¨æˆ‘ä»¬ä¸‹è½½çš„ jdk ç‰ˆæœ¬è¿›è¡Œå®‰è£…ã€‚</p><h2 id="3-è®¾ç½®é»˜è®¤-jdk"><a href="#3-è®¾ç½®é»˜è®¤-jdk" class="headerlink" title="3. è®¾ç½®é»˜è®¤ jdk"></a>3. è®¾ç½®é»˜è®¤ jdk</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jdk7</span><br><span class="line">sudo update-java-alternatives -s java-7-oracle</span><br><span class="line"></span><br><span class="line">jdk8</span><br><span class="line">sudo update-java-alternatives -s java-8-oracle</span><br></pre></td></tr></table></figure><h2 id="4-æµ‹è¯•å®‰è£…"><a href="#4-æµ‹è¯•å®‰è£…" class="headerlink" title="4. æµ‹è¯•å®‰è£…"></a>4. æµ‹è¯•å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line"></span><br><span class="line">javac -version</span><br></pre></td></tr></table></figure><h1 id="äºŒã€é€šè¿‡å®˜ç½‘ä¸‹-jdk-å‹ç¼©åŒ…å®‰è£…"><a href="#äºŒã€é€šè¿‡å®˜ç½‘ä¸‹-jdk-å‹ç¼©åŒ…å®‰è£…" class="headerlink" title="äºŒã€é€šè¿‡å®˜ç½‘ä¸‹ jdk å‹ç¼©åŒ…å®‰è£…"></a>äºŒã€é€šè¿‡å®˜ç½‘ä¸‹ jdk å‹ç¼©åŒ…å®‰è£…</h1><h2 id="1-å®˜ç½‘ä¸‹è½½-jdk-å‹ç¼©åŒ…shell"><a href="#1-å®˜ç½‘ä¸‹è½½-jdk-å‹ç¼©åŒ…shell" class="headerlink" title="1. å®˜ç½‘ä¸‹è½½ jdk å‹ç¼©åŒ…shell"></a>1. å®˜ç½‘ä¸‹è½½ jdk å‹ç¼©åŒ…shell</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a>ï¼Œé€‰æ‹©ç›¸åº”ç‰ˆæœ¬çš„ jdk ï¼Œå¹¶ä¸‹è½½å‹ç¼©åŒ…ã€‚</p><h2 id="2-åˆ›å»ºç›®å½•å¹¶è§£å‹ç¼©-jdk"><a href="#2-åˆ›å»ºç›®å½•å¹¶è§£å‹ç¼©-jdk" class="headerlink" title="2. åˆ›å»ºç›®å½•å¹¶è§£å‹ç¼© jdk"></a>2. åˆ›å»ºç›®å½•å¹¶è§£å‹ç¼© jdk</h2><p>åˆ›å»ºç›®å½•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/lib/jvm</span><br></pre></td></tr></table></figure><p>è§£å‹ç¼©åˆ°åˆ›å»ºçš„ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf jdk-8u66-linux-x64.tar.gz -C /usr/lib/jvm</span><br></pre></td></tr></table></figure><h2 id="3-å¢åŠ -jdk-ç¯å¢ƒå˜é‡"><a href="#3-å¢åŠ -jdk-ç¯å¢ƒå˜é‡" class="headerlink" title="3. å¢åŠ  jdk ç¯å¢ƒå˜é‡"></a>3. å¢åŠ  jdk ç¯å¢ƒå˜é‡</h2><p>ä¿®æ”¹linuxç¯å¢ƒå˜é‡æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>set oracle jdk environment</span><br><span class="line">export JAVA_HOME="/usr/lib/jvm/jdk1.8.0_66"</span><br><span class="line">export PATH="$PATH:$JAVA_HOME/bin"</span><br><span class="line">export JRE_HOME="$JAVA_HOME/jre"</span><br><span class="line">export CLASSPATH=".:$JAVA_HOME/lib:$JRE_HOME/lib"</span><br></pre></td></tr></table></figure><h2 id="4-ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ"><a href="#4-ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ" class="headerlink" title="4.ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ"></a>4.ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h2 id="5-è®¾ç½®ç³»ç»Ÿé»˜è®¤-jdk"><a href="#5-è®¾ç½®ç³»ç»Ÿé»˜è®¤-jdk" class="headerlink" title="5. è®¾ç½®ç³»ç»Ÿé»˜è®¤ jdk"></a>5. è®¾ç½®ç³»ç»Ÿé»˜è®¤ jdk</h2><p>å› ä¸ºè®¸å¤š linux é»˜è®¤å®‰è£…æœ‰ openjdk ï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè®¾ç½®é»˜è®¤ jdk</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.8.0_66/bin/java 300 </span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/jdk1.8.0_66/bin/javac 300 </span><br><span class="line">sudo update-alternatives --install /usr/bin/jar jar /usr/lib/jvm/jdk1.8.0_66/bin/jar 300 </span><br><span class="line">sudo update-alternatives --install /usr/bin/javah javah /usr/lib/jvm/jdk1.8.0_66/bin/javah 300 </span><br><span class="line">sudo update-alternatives --install /usr/bin/javap javap /usr/lib/jvm/jdk1.8.0_66/bin/javap 300</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„300åªæ˜¯æ ‡è¯†ä¸€ä¸‹ï¼Œæ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåªæ˜¯ä¸‹ä¸€æ­¥è¦ç”¨åˆ°<br>ç„¶åæ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --config java</span><br></pre></td></tr></table></figure><p>è‹¥æ˜¯åˆæ¬¡å®‰è£… jdk, ä¼šæœ‰ä¸‹é¢çš„æç¤º<br><code>There is only one alternative in link group java (providing /usr/bin/java)</code><br>å¦è€… , ä¼šåˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰å·²å®‰è£…çš„ javaï¼Œç„¶åè‡ªå·±é€‰æ‹©ï¼Œå³é€‰æœ€åä¸º300çš„é‚£ä¸ª</p><h2 id="6-æµ‹è¯•-jdk-æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#6-æµ‹è¯•-jdk-æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="6. æµ‹è¯• jdk æ˜¯å¦å®‰è£…æˆåŠŸ"></a>6. æµ‹è¯• jdk æ˜¯å¦å®‰è£…æˆåŠŸ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line"></span><br><span class="line">javac -version</span><br></pre></td></tr></table></figure><h1 id="å¦å¤–"><a href="#å¦å¤–" class="headerlink" title="å¦å¤–"></a>å¦å¤–</h1><p>åˆ é™¤é€šè¿‡ ppa å®‰è£…çš„ jdk </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove oracle-java8-installer</span><br></pre></td></tr></table></figure><p>å¥½ï¼Œä»¥ä¸Šå°±å®‰è£… jdk çš„ä¸¤ç§æ–¹æ³•ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ€»ç»“ ubuntu ç³»ç»Ÿä¸‹å®‰è£… Oracle JDK çš„æ–¹æ³•ï¼Œæ–¹ä¾¿å¤§å®¶ï¼Œä»¥åŠå¤‡ä»¥åä½¿ç”¨ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://blog.51itzone.cn/categories/Technology/"/>
    
      <category term="Java" scheme="https://blog.51itzone.cn/categories/Technology/Java/"/>
    
    
      <category term="Java" scheme="https://blog.51itzone.cn/tags/Java/"/>
    
      <category term="Ubuntu" scheme="https://blog.51itzone.cn/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>è®°å½•æˆä¸ºæ›´å¥½çš„è‡ªå·±</title>
    <link href="https://blog.51itzone.cn/2016/02/10/record-to-be-better/"/>
    <id>https://blog.51itzone.cn/2016/02/10/record-to-be-better/</id>
    <published>2016-02-10T12:46:25.000Z</published>
    <updated>2018-08-20T02:11:16.649Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‡äº‹å¼€å¤´éš¾ï¼Œä¸ç®¡åšä»€ä¹ˆæœ€éš¾çš„å°±æ˜¯ä»é›¶åˆ°ä¸€çš„è¿‡ç¨‹ã€‚ä¸€ç›´ä»¥æ¥éƒ½æƒ³æ­å»ºè‡ªå·±çš„åšå®¢æ¥è®°å½•è‡ªå·±çš„æ‰€æ€ã€æ‰€æƒ³ã€æ‰€æ„Ÿã€‚å†™åšå®¢åœ¨äºåšæŒï¼ŒåšæŒä¸‹æ¥è®°å½•è‡ªå·±çš„ç”Ÿæ´»å’Œæƒ³æ³•ï¼Œç•™ä¸‹ä¸€äº›è®°å¿†ã€‚<br><a id="more"></a></p><ul><li>å†™åšå®¢çš„å¥½å¤„</li><li>å¦‚ä½•æ‰èƒ½åšæŒå†™åšå®¢</li></ul><h2 id="ä¸€-å†™åšå®¢çš„å¥½å¤„"><a href="#ä¸€-å†™åšå®¢çš„å¥½å¤„" class="headerlink" title="ä¸€.å†™åšå®¢çš„å¥½å¤„"></a>ä¸€.å†™åšå®¢çš„å¥½å¤„</h2><h3 id="1ã€å­¦ä¹ å†™blogçš„æŠ€å·§"><a href="#1ã€å­¦ä¹ å†™blogçš„æŠ€å·§" class="headerlink" title="1ã€å­¦ä¹ å†™blogçš„æŠ€å·§"></a>1ã€å­¦ä¹ å†™blogçš„æŠ€å·§</h3><p>æ²¡æœ‰äººå¤©ç”Ÿä¼šå†™blogï¼Œä¸æ–­å°è¯•ï¼Œæ€è€ƒæ‰€å†™çš„å†…å®¹ï¼Œæ‰ä¼šç»ƒå°±å†™å‡ºå¤§å®¶å–œæ¬¢çš„åšæ–‡ã€‚</p><h3 id="2ã€ç¼–å†™è¯»ä¹¦ç¬”è®°"><a href="#2ã€ç¼–å†™è¯»ä¹¦ç¬”è®°" class="headerlink" title="2ã€ç¼–å†™è¯»ä¹¦ç¬”è®°"></a>2ã€ç¼–å†™è¯»ä¹¦ç¬”è®°</h3><p>ä¹¦è¯»äº†å¾ˆå¤šï¼Œå‘ç°è‡ªå·±æ²¡æœ‰æ”¶è·ï¼Œç”¨è¯»ä¹¦ç¬”è®°æ¥æ€»ç»“å¿ƒå¾—æ˜¯ä¸ªå¾ˆä¸é”™çš„åšæ³•ã€‚</p><h3 id="3ã€åˆ¶å®šå­¦ä¹ è®¡åˆ’"><a href="#3ã€åˆ¶å®šå­¦ä¹ è®¡åˆ’" class="headerlink" title="3ã€åˆ¶å®šå­¦ä¹ è®¡åˆ’"></a>3ã€åˆ¶å®šå­¦ä¹ è®¡åˆ’</h3><ul><li>å­¦ä¹ è¿‡çš„çŸ¥è¯†éœ€è¦æ€»ç»“ï¼Œç»å¸¸å¤ä¹ å›é¡¾ï¼Œä¸ç„¶æ—¶é—´ä¹…äº†å°±ä¼šé—å¿˜ã€‚æŠŠæ‰€å­¦ä¹ çš„çŸ¥è¯†åˆ†äº«å‡ºæ¥ï¼Œä¸å¤§å®¶äº¤æµå­¦ä¹ ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿè¦å®šæœŸå›é¡¾æ€»ç»“ï¼Œæ¸©æ•…çŸ¥æ–°ä¹ˆã€‚</li></ul><h3 id="4ã€å¯ä»¥æˆå°±å’Œäº†è§£è‡ªæˆ‘"><a href="#4ã€å¯ä»¥æˆå°±å’Œäº†è§£è‡ªæˆ‘" class="headerlink" title="4ã€å¯ä»¥æˆå°±å’Œäº†è§£è‡ªæˆ‘"></a>4ã€å¯ä»¥æˆå°±å’Œäº†è§£è‡ªæˆ‘</h3><p>æ–‡ç« å†™çš„å¤šäº†ï¼Œå°±ä¼šå‘ç°è‡ªå·±ä»€ä¹ˆåœ°æ–¹å¯ä»¥æƒ³æ¸…æ¥šï¼Œä»€ä¹ˆåœ°æ–¹éœ€è¦æ”¹è¿›å’Œå®Œå–„ï¼Œå†™ç€å†™ç€å°±ä¼šå¯¹è‡ªå·±è®¤è¯†çš„æ›´æ¸…æ™°ï¼Œä½ æœ€ç»ˆä¼šæ˜ç™½è‡ªå·±æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„äººï¼Œå’Œè‡ªå·±æ‰€æ„Ÿå…´è¶£çš„æ˜¯ä»€ä¹ˆã€‚</p><h2 id="äºŒã€å¦‚ä½•æ‰èƒ½åšæŒå†™åšå®¢"><a href="#äºŒã€å¦‚ä½•æ‰èƒ½åšæŒå†™åšå®¢" class="headerlink" title="äºŒã€å¦‚ä½•æ‰èƒ½åšæŒå†™åšå®¢"></a>äºŒã€å¦‚ä½•æ‰èƒ½åšæŒå†™åšå®¢</h2><h3 id="1ã€åšæŒï¼Œæ˜¯ä¸€ç§ä¼˜ç§€ä¹ æƒ¯"><a href="#1ã€åšæŒï¼Œæ˜¯ä¸€ç§ä¼˜ç§€ä¹ æƒ¯" class="headerlink" title="1ã€åšæŒï¼Œæ˜¯ä¸€ç§ä¼˜ç§€ä¹ æƒ¯"></a>1ã€åšæŒï¼Œæ˜¯ä¸€ç§ä¼˜ç§€ä¹ æƒ¯</h3><p>åšæŒå†™åšå®¢éœ€è¦åšçš„ä»¥ä¸‹å››ç‚¹ï¼šå®è·µã€åæ€ã€æ€»ç»“ã€åšæŒã€‚ä¸æ–­çš„å»åœ¨å®è·µä¸­æ€»ç»“åæ€ã€ä¼˜åŒ–ã€åšæŒï¼Œæ‰èƒ½çœŸæ­£å­¦ä¹ åˆ°ç²¾é«“ã€‚</p><h3 id="2ã€æ—¶æ—¶åˆ»åˆ»çš„éƒ½è¦å‡†å¤‡å¥½å¼€å§‹å†™ä½œ"><a href="#2ã€æ—¶æ—¶åˆ»åˆ»çš„éƒ½è¦å‡†å¤‡å¥½å¼€å§‹å†™ä½œ" class="headerlink" title="2ã€æ—¶æ—¶åˆ»åˆ»çš„éƒ½è¦å‡†å¤‡å¥½å¼€å§‹å†™ä½œ"></a>2ã€æ—¶æ—¶åˆ»åˆ»çš„éƒ½è¦å‡†å¤‡å¥½å¼€å§‹å†™ä½œ</h3><p>å–„äºåˆ©ç”¨èº«è¾¹çš„å·¥å…·ï¼Œæ¯”å¦‚Evernoteã€æœ‰é“äº‘ç¬”è®°ã€‚å½“æˆ‘ä»¬æœ‰å†™ä½œçš„æƒ³æ³•ï¼Œä½†æ˜¯æ—¶é—´ä¸å…è®¸ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å·¥å…·é‡Œå…ˆæ‹Ÿå¥½è¦å†™çš„æçº²å’Œæ€è€ƒåæ€»ç»“å‡ºçš„å†…å®¹ã€‚</p><h3 id="3ã€æ”¶é›†å†™ä½œå†…å®¹ï¼Œå¹¶è½¬åŒ–ä¸ºè‡ªå·±çš„æ–‡ç« "><a href="#3ã€æ”¶é›†å†™ä½œå†…å®¹ï¼Œå¹¶è½¬åŒ–ä¸ºè‡ªå·±çš„æ–‡ç« " class="headerlink" title="3ã€æ”¶é›†å†™ä½œå†…å®¹ï¼Œå¹¶è½¬åŒ–ä¸ºè‡ªå·±çš„æ–‡ç« "></a>3ã€æ”¶é›†å†™ä½œå†…å®¹ï¼Œå¹¶è½¬åŒ–ä¸ºè‡ªå·±çš„æ–‡ç« </h3><p>æ¨èå¤§å®¶ä½¿ç”¨[ç¨åé˜…è¯»]åŠŸèƒ½ï¼Œæ¯”å¦‚çŸ¥åçš„<a href="https://getpocket.com/" target="_blank" rel="noopener">Pocket</a>,æ”¯æŒå¤šç»ˆç«¯åŒæ­¥ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥æŠŠè‡ªå·±æƒ³å†™çš„å†…å®¹æ”¶é›†èµ·æ¥ï¼Œç­‰æœ‰ç©ºäº†è¿›è¡Œæ¶ˆåŒ–ã€æ€»ç»“å’Œå†™ä½œã€‚</p><h3 id="4ã€åšæŒå†™ä½œï¼Œå®Œæˆè‡ªæˆ‘çš„è¥é”€"><a href="#4ã€åšæŒå†™ä½œï¼Œå®Œæˆè‡ªæˆ‘çš„è¥é”€" class="headerlink" title="4ã€åšæŒå†™ä½œï¼Œå®Œæˆè‡ªæˆ‘çš„è¥é”€"></a>4ã€åšæŒå†™ä½œï¼Œå®Œæˆè‡ªæˆ‘çš„è¥é”€</h3><p>ç°åœ¨æ˜¯è‡ªåª’ä½“çš„å¤©ä¸‹ï¼Œåœ¨è¿™å‘è¾¾çš„äº’è”ç½‘æµªæ½®é‡Œï¼Œæˆ‘ä»¬éœ€è¦å­¦ä¼šè¥é”€è‡ªå·±ï¼Œå±•ç¤ºè‡ªå·±æ‰åï¼Œä¸ºè‡ªå·±åˆ›é€ ä»·å€¼ä¹Ÿä¸ºä»–äººåˆ›å»ºä»·å€¼ï¼Œå®ç°å…±èµ¢ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>å†™åšå®¢åœ¨äºåšæŒï¼Œä¸‰åˆ†çƒ­åº¦æˆå°±ä¸äº†è‡ªå·±ï¼Œä¹Ÿä¸èƒ½ç»™åˆ«äººå¸¦æ¥å¸®åŠ©å’Œä»·å€¼ã€‚åˆ¶å®šå‡ºæ˜ç¡®çš„è®¡åˆ’ï¼ŒæŠŠè‡ªå·±çš„æ‰€å­¦è½¬æ¢æˆçŸ¥è¯†ä¼ é€’å‡ºå»ã€‚è®°å½•ï¼Œæˆä¸ºæ›´å¥½çš„è‡ªå·±ã€‚</p><blockquote><p>åˆ˜æœªé¹è¯´â€”â€”<br>å†™åšå®¢è¿™ä»¶äº‹æƒ…ç»™æˆ‘æœ€å¤§çš„ä½“ä¼šå°±æ˜¯ï¼Œä¸€ä»¶äº‹æƒ…å¦‚æœä½ èƒ½å¤ŸåšæŒåš8å¹´ï¼Œé‚£ä¹ˆä¸ç®¡æ•ˆç‡å’Œé¢‘ç‡å¤šä½ï¼Œæœ€ç»ˆæ€»èƒ½å–å¾—ä¸€äº›å¾ˆå¯è§‚çš„æ”¶ç›Šã€‚è€Œå¦ä¸€ä¸ªä½“ä¼šå°±æ˜¯ï¼Œä¸€ä»¶äº‹æƒ…åªè¦ä½ åšæŒå¾—è¶³å¤Ÿä¹…ï¼Œâ€œåšæŒâ€å°±ä¼šæ…¢æ…¢å˜æˆâ€œä¹ æƒ¯â€ã€‚åŸæœ¬éœ€è¦è´¹åŠ›å»é©±åŠ¨çš„äº‹æƒ…ä¾¿æˆäº†å®¶å¸¸ä¾¿é¥­ï¼Œäº‘æ·¡é£è½»ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸‡äº‹å¼€å¤´éš¾ï¼Œä¸ç®¡åšä»€ä¹ˆæœ€éš¾çš„å°±æ˜¯ä»é›¶åˆ°ä¸€çš„è¿‡ç¨‹ã€‚ä¸€ç›´ä»¥æ¥éƒ½æƒ³æ­å»ºè‡ªå·±çš„åšå®¢æ¥è®°å½•è‡ªå·±çš„æ‰€æ€ã€æ‰€æƒ³ã€æ‰€æ„Ÿã€‚å†™åšå®¢åœ¨äºåšæŒï¼ŒåšæŒä¸‹æ¥è®°å½•è‡ªå·±çš„ç”Ÿæ´»å’Œæƒ³æ³•ï¼Œç•™ä¸‹ä¸€äº›è®°å¿†ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="LifeStyle" scheme="https://blog.51itzone.cn/categories/LifeStyle/"/>
    
    
      <category term="LifeStyle" scheme="https://blog.51itzone.cn/tags/LifeStyle/"/>
    
  </entry>
  
</feed>
